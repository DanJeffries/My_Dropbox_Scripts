
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Phasing\_paper\_longform}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Phasing Ridibundus / Lessonae alleles from ddRADseq of
hibridogens}\label{phasing-ridibundus-lessonae-alleles-from-ddradseq-of-hibridogens}

    Date: Dec, 2018\\
Author: Dr. Daniel L. Jeffries, Department of Ecology and Evolution,
University of Lausanne, Switzerland\\
Email: dljeffries86@gmail.com

    In this notebook we phase alleles that are specific to the two
subgenomes present in hybridogenetic frogs from crosses between P.
ridibundus (R) and P. lessonae (L). Depending on the cross, either the R
or the L genome (or both) is clonal. Throughout, the clonal genome is
denoted with square brackets (e.g. an R{[}L{]}individual passes the L
genome clonally and never the R).

The data analysed below consist of both families, from several types of
cross (differing in which of the subgenomes is clonal).

The aim is to, for as many RADtags as possible, identify the R and L
alleles and output VCF files whith doubled-haploid genotypes to be used
in downstream analyses.

The data is in the form of a VCF of genotypes. We will first deal with
the family data only, thus the first VCF has genotypes for 5 familes:

Family\_25: Father\_13CZ3WF28M R{[}L{]} x Mother\_13CZ1WF3F\_RR\\
Family\_27: Father\_13CZ3WF40M {[}R{]}{[}L{]} x Mother\_13CZ1WF3F\_RR\\
Family\_30: Father\_13CZ3WF40M {[}R{]}{[}L{]} x Mother\_13CZ3WF10F\_RR\\
Family\_39: Father\_13CZ3WF31M {[}R{]}L x Mother\_13CZ3WF11F\_RR\\
Family\_41: Father\_13CZ3WF38M R{[}L{]} x Mother\_13CZ3WF11F\_RR

The approach here will be to phase loci separately in each family, and
then combine these phasings across families into a single VCF where each
sample is split into its constituent phased sub-genomes.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{o}{\PYZpc{}}\PY{k}{load\PYZus{}ext} rpy2.ipython 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{division}
        \PY{k+kn}{from} \PY{n+nn}{IPython.display} \PY{k+kn}{import} \PY{n}{Image}
        \PY{k+kn}{import} \PY{n+nn}{vcf}
        \PY{k+kn}{import} \PY{n+nn}{MISC\PYZus{}RAD\PYZus{}tools} \PY{k+kn}{as} \PY{n+nn}{MISC}  \PY{c+c1}{\PYZsh{}\PYZsh{} module of custom scripts which can be found here: https://github.com/DanJeffries/My\PYZus{}misc\PYZus{}scripts/blob/master/Python/My\PYZus{}Modules/MISC\PYZus{}RAD\PYZus{}tools.py }
\end{Verbatim}


    \subsection{The data "at a glance"}\label{the-data-at-a-glance}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{vcf\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie//Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted\PYZus{}Clones\PYZus{}and\PYZus{}LLs/batch\PYZus{}2.vcf}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{MISC}\PY{o}{.}\PY{n}{Summary\PYZus{}plotter}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1111}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n+nb+bp}{False}\PY{p}{)}  \PY{c+c1}{\PYZsh{}\PYZsh{} creates several plots for assessing the SNP calls from Stacks. }
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
\#\#\#\# DONE \#\#\#\#

Number of Loci = 15676
Average coverage = 16.208485016 reads

    \end{Verbatim}

    \subsubsection{Raw data summary}\label{raw-data-summary}

So the data looks very nice, and there is a realy clear difference in
heterozygosity between the individuals with the same genome (i.e. RR or
R{[}R{]}) and those with different genomes i.e. {[}R{]}L, R{[}L{]} or
{[}R{]}{[}L{]}.

So given this amount of heterozygosity, there must be a large number of
loci with genome specific alleles. So generally there will likely be
lots of loci with the potential to be phased.

    \section{Phasing strategy}\label{phasing-strategy}

Phasing families one by one is relatively trivial, the difficulty is
combining those phasings across families, as a SNP informative in one
family might not be in another. For this reason we have developed a
theoretical framework in which to consider categories of loci which are
informative in different ways and must therefore be treated in different
ways when combining across the families. These categories differ based
on the position at which the variant arose in the phylogenetic tree
which describes the relatedness of all R and L genomes in the sample
pool.

The tree below shows a theoretical tree between R and L loci (the real
tree is not known as it requires the phasing that we are trying to do!).
The loci categories are as follows:

\begin{itemize}
\item
  \(A^1\) loci: Loci containing snps which arose on either of the two
  basal red branches leading to the R or L clades. These will be
  diagnostic between R and L genomes, but not between different Rs or
  different Ls
\item
  \(A^2\) loci: Loci containing snps which arose on the red branches
  leading to separate L genomes. These will be diagnostic between R and
  L genomes, and may differ between L genomes, meaning the can also
  inform variation between L haplotypes.
\item
  \(B\) loci: Loci containing snps which arose on a branch leading to a
  clonal R genome. These can be diagnostic between {[}R{]} and L,
  between {[}R{]} and R and also may differ between different {[}R{]}
  genomes, making them informative for the origin of the different
  {[}R{]} clones.
\item
  \(C\) loci: Loci containing snps which arose on a branch leading to a
  sexual R genome and which are present in heterozygous form in both
  parents of the cross. These can be also shared by clonal R genomes
  recently derived from sexual Rs and will be informative for the
  variation between sexual and clonal Rs as well as of course being
  diagnostic between R and L.
\item
  \(D\) loci: Loci containing snps which arose on a branch leading to a
  sexual R genome and which are present in heterozygous form only one of
  the parents of the cross. These can be also shared by clonal R genomes
  recently derived from sexual Rs and will be informative for the
  variation between sexual and clonal Rs as well as of course being
  diagnostic between R and L.
\end{itemize}

These different types of variant are constrained in their possible
genotypes in the parents (and thus the offspring). For example, in the
cross RR x RL an \(A^1\) locus must be in the form 0/0 x 0/1 where "1"
here refers to the allelic variant specific to the L genome. If the RL
parent passes its L genome clonally (i.e. it is R{[}L{]}) then all
offspring must be RL and thus have the genotype 0/1. These expectations
are set out in cross-specific schematics below, and will inform the
tests implemented in the code below to characterise and phase each
category of loci.

Once each family is phased, the loci will be combined using checks for
discrepencies based on this tree.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{Image}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/Phasing\PYZus{}schematic\PYZus{}color\PYZus{}coordinated.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{900}\PY{p}{)}
\end{Verbatim}

\texttt{\color{outcolor}Out[{\color{outcolor}2}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_10_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsection{Family 25}\label{family-25}

The schematic below shows the different combinations of variants in the
cross for family 25 (and also 41), and what to expect in the offspring.
Locus types and their colours in the figure correspond to the phylogeny
schematic above and the same notation is used in the scripts. We will
use schematics like this for each crossing type to inform the
expectations of our scripts.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{Image}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/FAM\PYZus{}25\PYZus{}41\PYZus{}schematic.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{900}\PY{p}{)}
\end{Verbatim}

\texttt{\color{outcolor}Out[{\color{outcolor}5}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    Based on the family schematic above, the following expectations will be
tested in the following code blocks, to identify loci which fit each
category (A, B, C or D).

Test to find the \(a^L\) alleles:

\begin{itemize}
\tightlist
\item
  loci are heterozygous in the father (R{[}L{]})
\item
  loci are homozygous in the mother (RR).
\item
  loci are heterozygous in all offspring (all R{[}L{]})
\end{itemize}

\(a^L\) allele is then the allele which is specific to the father.

NOTE: this method might be sensitive to null alleles in the mother.

Test to find the \(b^{R1}\) alleles:

\begin{itemize}
\tightlist
\item
  loci are heterozygous in the father (R{[}L{]})
\item
  loci are homozygous in the mother (RR).
\item
  loci are homozygous in all offspring (all R{[}L{]})
\end{itemize}

\(b^{R1}\) allele is then the allele which is specific to the father.

NOTE: this method might be sensitive to null alleles in the father.

Test to find the \(c^{R2}\) alleles (C in figure above):

\begin{itemize}
\tightlist
\item
  loci are homozygous in the father (R{[}L{]}).
\item
  loci are heterozygous in the mother (RR)
\item
  loci are heterozygous in 50\% of offspring (all R{[}L{]})
\end{itemize}

\(c^{R2}\) allele is then the allele which is specific to the mother.

Test to find the \(d^R\) alleles:

\begin{itemize}
\tightlist
\item
  loci are fixed for alternate genotypes in the mother and father
\item
  loci are heterozygous in all offspring
\end{itemize}

\(d^R\) allele is then the allele which is specific to the mother.

NOTE: this method might be sensitive to null alleles in the father.

    \subsubsection{First get known sample
genotypes}\label{first-get-known-sample-genotypes}

Based on sample information we have a list of sample names and their
genotypes (RR or RL). This dictionary will be used throughout to examine
RR and RL samples separately.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} First, make a dictionary of samples and genotypes}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} open file containing sample genotypes e.g. RR, RL, LL}
        \PY{n}{sample\PYZus{}GTs} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/sample\PYZus{}GTs.txt}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{GT\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
        
        \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{sample\PYZus{}GTs}\PY{p}{:}
            \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{line}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
            
            
        \PY{c+c1}{\PYZsh{}\PYZsh{} open file containing more explicit sample genotypes e.g. R[R], R[L], LL etc.}
        \PY{n}{sample\PYZus{}GTs} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/sample\PYZus{}GTs\PYZus{}explicit.txt}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{GT\PYZus{}exp\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
        
        \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{sample\PYZus{}GTs}\PY{p}{:}
            \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]} \PY{o}{=} \PY{n}{line}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
            
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{Mother} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ1WF3F}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{Father} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF28M}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{15}
         
         \PY{n}{offspring\PYZus{}identifier} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{25\PYZus{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{o}{=} \PY{l+m+mf}{0.8}  \PY{c+c1}{\PYZsh{}\PYZsh{} out of 17 total offspring (allowing for a couple of missed calls)}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}record = myvcf.next() \PYZsh{} for testing}
         
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         
         \PY{n}{A\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{B\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{C\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{D\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{homomorphic\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{heterozygous\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for each locus in the vcf}
             
             \PY{n}{N\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}  \PY{c+c1}{\PYZsh{}\PYZsh{} counter for number of offspring in family}
             \PY{n}{het\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0} \PY{c+c1}{\PYZsh{}\PYZsh{} counter for number of heterozygous offspring}
             \PY{n}{N\PYZus{}offspring\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}  \PY{c+c1}{\PYZsh{}\PYZsh{} counter for number of offspring called at this locus}
             \PY{n}{offspring\PYZus{}alleles} \PY{o}{=} \PY{p}{[}\PY{p}{]}  \PY{c+c1}{\PYZsh{}\PYZsh{} record alleles in offspring }
             
             \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}    \PY{c+c1}{\PYZsh{}\PYZsh{} for all samples at this locus}
                 
                 \PY{k}{if} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                     \PY{n}{N\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count the number of offspring (gets done each locus, not efficient but works) }
                 
                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{:}
                 
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Mother}\PY{p}{:}
                         \PY{n}{Mother\PYZus{}called} \PY{o}{=} \PY{n+nb+bp}{True}  \PY{c+c1}{\PYZsh{}\PYZsh{} logical for if mother called?}
                         \PY{n}{Mother\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}  \PY{c+c1}{\PYZsh{}\PYZsh{} logical for if mother her}
                         \PY{n}{Mothers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{}\PYZsh{} get mothers genotype \PYZdq{}0/0\PYZdq{} format}
                         \PY{n}{Mothers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}  \PY{c+c1}{\PYZsh{}\PYZsh{} get mothers genotype \PYZdq{}A/A\PYZdq{} format}
         
                     \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Father}\PY{p}{:}  \PY{c+c1}{\PYZsh{} same for father}
                         \PY{n}{Father\PYZus{}called} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Father\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Fathers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Fathers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
         
                     \PY{k}{elif} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if sample is offspring}
         
                         \PY{n}{N\PYZus{}offspring\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count the offspring call}
                         \PY{n}{offspring\PYZus{}alleles}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                         \PY{n}{offspring\PYZus{}alleles}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                             \PY{n}{het\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count if the offspring is heterozygous. }
                         
         
             \PY{c+c1}{\PYZsh{}\PYZsh{} now perform tests to see if locus fits the criteraia for being phasable.            }
                         
             \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{N\PYZus{}offspring\PYZus{}called} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n}{N\PYZus{}offspring}\PY{o}{*}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if there are enough calls at the locus.}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} A loci}
                 
                 \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if mother is homozygous, father is heterozygous, and offspring are heterozygous (above threshold)}
                     
                     \PY{n}{A\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count locus as phasable}
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} now get the aL allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for the alleles in the father}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if allele not in mother}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make an entry in the phased dictionary, recording the L and R alleles at this locus in this family.}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}} 
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} B loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:} 
                     
                     \PY{n}{B\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count locus as phasable}
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} now get the bR1 allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for the alleles in the father}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if allele not in mother}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make an entry in the phased dictionary, recording the L and R alleles at this locus in this family.}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}} 
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=}  \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                         
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} C loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{l+m+mf}{0.4} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.6} \PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                     \PY{n}{C\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count locus as phasable}
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} now get the cR2 allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for the alleles in the father}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if allele not in mother}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make an entry in the phased dictionary, recording the L and R alleles at this locus in this family.}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}} 
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=}  \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} D loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{!=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                     \PY{n}{D\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count D locus }
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} now get the dR allele.}
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{offspring\PYZus{}alleles}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{homomorphic\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{heterozygous\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{else}\PY{p}{:}
                     
                     \PY{c+c1}{\PYZsh{}print \PYZdq{}LOCUS: \PYZpc{}s: Mothers GT: \PYZpc{}s, Fathers GT: \PYZpc{}s, Offspring heterozygosity: \PYZpc{}s, Offspring alleles: \PYZpc{}s\PYZdq{} \PYZpc{} (record.ID, Mothers\PYZus{}GT\PYZus{}bases, Fathers\PYZus{}GT\PYZus{}bases, (het\PYZus{}offspring / N\PYZus{}offspring\PYZus{}called), set(offspring\PYZus{}alleles))}
                     
                     \PY{n}{not\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
             
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ A loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{A\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ B loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{B\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ C loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{C\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ D loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{D\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci homomorphic in this family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{homomorphic\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci heterozygous in both parents}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{heterozygous\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ Not phasable}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ Not enough data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}enough\PYZus{}data}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
1342 A loci
186 B loci
53 C loci
138 D loci
302 loci homomorphic in this family
197 loci heterozygous in both parents
304 Not phasable
7361 Not enough data

    \end{Verbatim}

    So a lot of loci can be phased between R and L. Fewer for the male
specific R but still quite a few - I think this is to be expected as the
male and female come different populations. And the number of loci
polymorphic in the female is relatively small.

There are some loci left over (listed as "Not phasable") which consist
of loci with various issues - many likely due to either null alleles in
parents, or paralogous overmerged loci. Either way they are of no use so
I didn't try to catch these edge cases explicitly. It is enough just to
know that they are because of the inevitable messiness in RAD data.

Note I have put a pretty strict coverage cut off on here so a lot of
loci get kicked out (listed as "Not enough data") - hopefully this means
we are dealing with pretty clean data, and not many loci are needed just
to look at structure between sub-genomes, so I think this is the best
strategy.

    \subsection{Family 41}\label{family-41}

Same schamatic as above

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} same as for Family 25}
         
         \PY{n}{Mother} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF11F}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{Father} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF38M}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{offspring\PYZus{}identifier} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41\PYZus{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{o}{=} \PY{l+m+mf}{0.8}  \PY{c+c1}{\PYZsh{}\PYZsh{} out of 17 total offspring (allowing for a couple of missed calls)}
         
         \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{15}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}record = myvcf.next()}
         
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{A\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{B\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{C\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{D\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{homomorphic\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{heterozygous\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             \PY{n}{N\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{het\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{N\PYZus{}offspring\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
             
             \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                 
                 \PY{k}{if} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                     \PY{n}{N\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count the number of offspring (gets done each locus, not efficient but works) }
                 
                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{:}
                 
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Mother}\PY{p}{:}
                         \PY{n}{Mother\PYZus{}called} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Mother\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Mothers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Mothers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
         
                     \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Father}\PY{p}{:}
                         \PY{n}{Father\PYZus{}called} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Father\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Fathers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Fathers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
         
                     \PY{k}{elif} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
             
                         \PY{n}{N\PYZus{}offspring\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                             \PY{n}{het\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
             \PY{c+c1}{\PYZsh{}\PYZsh{} now perform tests to see if locus fits the criteraia for being phasable.            }
                         
             \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{N\PYZus{}offspring\PYZus{}called} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n}{N\PYZus{}offspring}\PY{o}{*}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if there are enough calls at the locus.}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} A loci}
                 
                 \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if mother is homozygous, father is heterozygous, and offspring are heterozygous (above threshold)}
                     
                     \PY{n}{A\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count locus as phasable}
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} now get the aL allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for the alleles in the father}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if allele not in mother}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make an entry in the phased dictionary, recording the L and R alleles at this locus in this family.}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}} 
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=}  \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} B loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{o}{*}\PY{p}{(}\PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:} 
                     
                     \PY{n}{B\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count locus as phasable}
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} now get the bR1 allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for the alleles in the father}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if allele not in mother}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make an entry in the phased dictionary, recording the L and R alleles at this locus in this family.}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}} 
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=}  \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                         
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} C loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{l+m+mf}{0.4} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.6} \PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                     \PY{n}{C\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count locus as phasable}
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} now get the cR2 allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for the alleles in the father}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if allele not in mother}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make an entry in the phased dictionary, recording the L and R alleles at this locus in this family.}
                             
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}} 
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=}  \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} D loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{!=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                     \PY{n}{D\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count D locus }
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} now get the dR allele.}
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                           
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{==} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{offspring\PYZus{}alleles}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{homomorphic\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{heterozygous\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{else}\PY{p}{:}
         
                     \PY{n}{not\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
             \PY{k}{else}\PY{p}{:}
                                
                 \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ A loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{A\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ B loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{B\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ C loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{C\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ D loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{D\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci homomorphic in this family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{homomorphic\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci heterozygous in both parents}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{heterozygous\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ Not phasable}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ Not enough data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}enough\PYZus{}data}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
818 A loci
92 B loci
55 C loci
70 D loci
56 loci homomorphic in this family
119 loci heterozygous in both parents
317 Not phasable
8356 Not enough data

    \end{Verbatim}

    Numbers per locus category are comparable to those of family 25.

Now I will compare these phasings between then two families.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}718}]:} \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of loci phased in family 25 = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n+nb}{len}\PY{p}{(}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of loci phased in family 41 = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n+nb}{len}\PY{p}{(}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{all\PYZus{}phased} \PY{o}{=} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)} \PY{o}{+} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
          
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of loci phased in at least one family = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{all\PYZus{}phased}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{aL\PYZus{}both\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
          \PY{n}{aL\PYZus{}matches} \PY{o}{=} \PY{l+m+mi}{0}
          
          \PY{n}{b\PYZus{}both\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
          \PY{n}{b\PYZus{}matches} \PY{o}{=} \PY{l+m+mi}{0}
          
          \PY{n}{c\PYZus{}both\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
          \PY{n}{c\PYZus{}matches} \PY{o}{=} \PY{l+m+mi}{0}
          
          
          \PY{k}{for} \PY{n}{shared\PYZus{}locus} \PY{o+ow}{in} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{viewkeys}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZam{}} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{viewkeys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{n}{aL\PYZus{}both\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
              \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                  \PY{n}{aL\PYZus{}matches} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                  
              \PY{c+c1}{\PYZsh{}else:}
                  \PY{c+c1}{\PYZsh{}print shared\PYZus{}locus}
                  \PY{c+c1}{\PYZsh{}print phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon[\PYZdq{}A\PYZus{}loci\PYZdq{}][shared\PYZus{}locus][\PYZdq{}aL\PYZdq{}], phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR[\PYZdq{}A\PYZus{}loci\PYZdq{}][shared\PYZus{}locus][\PYZdq{}aL\PYZdq{}]}
                  \PY{c+c1}{\PYZsh{}print phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon[\PYZdq{}A\PYZus{}loci\PYZdq{}][shared\PYZus{}locus][\PYZdq{}a\PYZdq{}], phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR[\PYZdq{}A\PYZus{}loci\PYZdq{}][shared\PYZus{}locus][\PYZdq{}a\PYZdq{}]}
              
          \PY{k}{for} \PY{n}{shared\PYZus{}locus} \PY{o+ow}{in} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{viewkeys}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZam{}} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{viewkeys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{n}{b\PYZus{}both\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
              \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                  \PY{n}{b\PYZus{}matches} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                  
              \PY{c+c1}{\PYZsh{}else:}
                  \PY{c+c1}{\PYZsh{}print shared\PYZus{}locus}
                  \PY{c+c1}{\PYZsh{}print phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon[\PYZdq{}B\PYZus{}loci\PYZdq{}][shared\PYZus{}locus][\PYZdq{}b\PYZus{}R1\PYZdq{}], phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR[\PYZdq{}B\PYZus{}loci\PYZdq{}][shared\PYZus{}locus][\PYZdq{}b\PYZus{}R1\PYZdq{}]}
                  \PY{c+c1}{\PYZsh{}print phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon[\PYZdq{}B\PYZus{}loci\PYZdq{}][shared\PYZus{}locus][\PYZdq{}b\PYZdq{}], phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR[\PYZdq{}B\PYZus{}loci\PYZdq{}][shared\PYZus{}locus][\PYZdq{}b\PYZdq{}]}
                  
          \PY{k}{for} \PY{n}{shared\PYZus{}locus} \PY{o+ow}{in} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{viewkeys}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZam{}} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{viewkeys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{n}{c\PYZus{}both\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
              \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{shared\PYZus{}locus}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                  \PY{n}{c\PYZus{}matches} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
          
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Number of A loci phased in both families = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{aL\PYZus{}both\PYZus{}count}
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of consistent A phasings in shared loci = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{aL\PYZus{}matches}
          
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Number of B loci phased in both families = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{b\PYZus{}both\PYZus{}count}
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of consistent B phasings in shared loci = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}}  \PY{n}{b\PYZus{}matches}
          
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Number of C loci phased in both families = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{c\PYZus{}both\PYZus{}count}
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of consistent C phasings in shared loci = }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{c\PYZus{}matches}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number of loci phased in family 25 = 1937
Number of loci phased in family 41 = 1067
Number of loci phased in at least one family = 2229

Number of A loci phased in both families = 775
Number of consistent A phasings in shared loci = 708 

Number of B loci phased in both families = 45
Number of consistent B phasings in shared loci = 31 

Number of C loci phased in both families = 0
Number of consistent C phasings in shared loci = 0 

    \end{Verbatim}

    So, many of the A loci which could be phased for R vs L were shared
among both families - and their phasings almost always completely
matched. The cases that don't (about 85 of them) are weired, the SNP in
one family seems completely different from that of the other family,
e.g. A/T in one family and C/G in the other, at the same site. Maybe
this is a paralog issue? I find it hard to believe that there has been
two independent mutations at the same site between these families.

For the B loci specific to the male R, not many phased in both families,
but again very few disagreed. In all cases the bases are the same, but
the phase is just reversed between families - not sure how this can
occur. In both families, the male is always heterozygous, the allele
phased is the one which is not in the mother, and it is never in the
offspring - so how do these inconsistencies between the families arise?
Maybe some ancestral polymorphism? Maybe come back to this if it seems
significant, but for now, given that it is so few loci, lets move on.

    \subsubsection{So what happens to the loci that can be phased in one
family and not the
other?}\label{so-what-happens-to-the-loci-that-can-be-phased-in-one-family-and-not-the-other}

\begin{itemize}
\tightlist
\item
  are these loci missing in those families?
\item
  are they not phasable in those families?

  \begin{itemize}
  \tightlist
  \item
    if so why? No L specific allele?
  \end{itemize}
\end{itemize}

lets take a look at things and see whats going on . . .

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}\PYZsh{} get loci that are phased in family 25 and not in family 41}
        \PY{n}{Mother\PYZus{}41} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF11F}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{Father\PYZus{}41} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF38M}\PY{l+s+s2}{\PYZdq{}}
        
        \PY{n}{Mother\PYZus{}25} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ1WF3F}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{Father\PYZus{}25} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF28M}\PY{l+s+s2}{\PYZdq{}}
        
        
        \PY{n}{not\PYZus{}shared} \PY{o}{=} \PY{p}{[}\PY{p}{]}
        
        \PY{k}{for} \PY{n}{locus} \PY{o+ow}{in} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25\PYZus{}RLclon}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
            \PY{k}{if} \PY{n}{locus} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41\PYZus{}LclonR}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                \PY{n}{not\PYZus{}shared}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{locus}\PY{p}{)}
        
        \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
        
        \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
            \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{not\PYZus{}shared}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{:}
                \PY{k}{print} \PY{n}{record}\PY{o}{.}\PY{n}{ID}
                \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                    \PY{k}{if} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{25\PYZus{}}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{or} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41\PYZus{}}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{or} \PY{n}{Mother\PYZus{}25} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{or} \PY{n}{Father\PYZus{}25} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{or} \PY{n}{Mother\PYZus{}41} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{or} \PY{n}{Father\PYZus{}41} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                        \PY{k}{print} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}


    So mostly it seems that the reason loci were phased in one family and
not the other was because of missing data in too many offspring or one
of the parents. But there were a couple of examples where either both
parents were homozygous for different alleles (and all offspring were
heterozygous suggesting this is real, not a null allele in one parent),
or where there was an excess of homozygotes for the minor parental
allele. I guess this could be caused by all sorts of things, e.g. null
allele in one parent (so there were in fact two heterozygous parents due
to shared ancestral polymorphism(?))

    \subsection{Families 27 and 30}\label{families-27-and-30}

    Both families 27 and 30 have the mating combination {[}R{]}{[}L{]} x RR

In these families, two types of offspring will be produced, R{[}R{]} and
R{[}L{]}. Both of which can be used, the R{[}R{]} individuals can be
used to find alleles specific to the {[}R{]} genome, which are not
present in the sexual R genome. However, these are likely to be very
few, as the {[}R{]} genome can only stay clonal for a single generation.
Also, the heterozygosity plot above suggests that there will be very
very few as well.

The R{[}L{]} samples will be useful for find thing L and R specific
alleles in this family.

    \subsection{Family 27}\label{family-27}

 Phasing R vs L loci again here first

Note that Family 27 has the same mother as family 25. So the resulting
phased R genomes should be pretty much identical at the share loci.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{Image}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/FAM\PYZus{}27\PYZus{}30\PYZus{}schematic.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{900}\PY{p}{)}
\end{Verbatim}

\texttt{\color{outcolor}Out[{\color{outcolor}3}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    Based on the family schematic above, the following expectations will be
tested in the following code blocks, to identify loci which fit each
category (A, B, C or D).

Test to find the \(a^L\) alleles:

\begin{itemize}
\tightlist
\item
  loci are heterozygous in the father (R{[}L{]})
\item
  loci are homozygous in the mother (RR).
\item
  loci are homozygous in all {[}R{]}R offspring and heterozygous in all
  R{[}L{]} offspring.
\end{itemize}

\(a^L\) allele is then the allele which is specific to the father and
R{[}L{]} offspring.

NOTE: this method might be sensitive to null alleles in the mother.

Test to find the \(b^{R1}\) alleles:

\begin{itemize}
\tightlist
\item
  loci are heterozygous in the father (R{[}L{]})
\item
  loci are homozygous in the mother (RR).
\item
  loci are heterozygous in all {[}R{]}R offspring and homozygous (for
  maternal allele) in all R{[}L{]} offspring.
\end{itemize}

\(b^{R1}\) allele is then the allele which is specific to the father.

NOTE: this method might be sensitive to null alleles in the father.

Test to find the \(c^{R2}\) alleles (C in figure above):

\begin{itemize}
\tightlist
\item
  loci are homozygous in the father (RL).
\item
  loci are heterozygous in the mother (R{[}L{]})
\item
  loci are heterozygous in 50\% all R{[}L{]} offspring and heterozygous
  in 50\% of all {[}R{]}R offspring
\end{itemize}

\(c^{R2}\) allele is then the allele which is specific to the mother.

Test to find the \(d^R\) alleles:

\begin{itemize}
\tightlist
\item
  loci are fixed for alternate genotypes in the mother and father
\item
  loci are heterozygous in all offspring
\end{itemize}

\(d^R\) allele is then the allele which is specific to the mother.

NOTE: this method might be sensitive to null alleles in the father.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{Mother} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ1WF3F}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{Father} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF40M}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{offspring\PYZus{}identifier} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27\PYZus{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{o}{=} \PY{l+m+mf}{0.8}  
         
         \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{10}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{record} \PY{o}{=} \PY{n}{myvcf}\PY{o}{.}\PY{n}{next}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         
         \PY{n}{RR\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{RL\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{R2\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{D\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{homomorphic\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{heterozygous\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Use the offspring genotypes here, as I want to look at the R[R] and R[L] offspring separately here}
         
         \PY{n}{sample\PYZus{}GTs}
         
         \PY{n}{RR\PYZus{}offspring} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{RL\PYZus{}offspring} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             
             \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{RR\PYZus{}offspring\PYZus{}gts} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{RL\PYZus{}offspring\PYZus{}gts} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             
             \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} count offspring in family}
                 
                 \PY{k}{if} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                     \PY{k}{if} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{RR\PYZus{}offspring}\PY{p}{:}
                             \PY{n}{RR\PYZus{}offspring}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{RL\PYZus{}offspring}\PY{p}{:}
                             \PY{n}{RL\PYZus{}offspring}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} if coverage is high enough, record info of locus}
                 
                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{:}
                 
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Mother}\PY{p}{:}
                         \PY{n}{Mother\PYZus{}called} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Mother\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Mothers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Mothers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
                         
                     \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Father}\PY{p}{:}
                         \PY{n}{Father\PYZus{}called} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Father\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Fathers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Fathers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
                         
                     \PY{k}{elif} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                             
                             \PY{n}{RR\PYZus{}offspring\PYZus{}gts}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                                 \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                                 \PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 
                         \PY{k}{elif} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                             
                             \PY{n}{RL\PYZus{}offspring\PYZus{}gts}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                                 \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                                 \PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
             
             \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{RR\PYZus{}offspring}\PY{p}{)}\PY{o}{*}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{,} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{RL\PYZus{}offspring}\PY{p}{)}\PY{o}{*}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 
         
                 \PY{c+c1}{\PYZsh{}\PYZsh{} A loci \PYZhy{} R clon L samples}
                 
                 \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{RL\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} B loci \PYZhy{} R clon R samples}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{RR\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} C loci \PYZhy{} R2 loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{l+m+mf}{0.4} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring}\PY{o}{+}\PY{n}{het\PYZus{}RL\PYZus{}offspring}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{o}{+}\PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{R2\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} D loci }
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{!=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring}\PY{o}{+}\PY{n}{het\PYZus{}RL\PYZus{}offspring}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{o}{+}\PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{D\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{homomorphic\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{heterozygous\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{not\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} 
         
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ phasable loci for clonal L (A loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{RL\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ phasable loci for clonal R (B loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{RR\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci variable in female (C loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{R2\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ D loci }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{D\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci homomorphic in this family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{homomorphic\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci heterozygous in both parents}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{heterozygous\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci not phasable}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci with not enough data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}enough\PYZus{}data}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
629 phasable loci for clonal L (A loci)
31 phasable loci for clonal R (B loci)
33 loci variable in female (C loci)
33 D loci 
240 loci homomorphic in this family
81 loci heterozygous in both parents
301 loci not phasable
8534 loci with not enough data

    \end{Verbatim}

    So fewer loci can be phased here - previous runs found more, but with a
much lower coverage cut off - indeed coverage seems to be generally
lower in this family.

    \subsection{Family 30}\label{family-30}

Family\_30: Father\_13CZ3WF40M {[}R{]}{[}L{]} x Mother\_13CZ3WF10F\_RR

This family contains both {[}R{]}{[}L{]} offspring and R{[}R{]}
offspring.

So phasing for both

 Phasing R vs L loci and also R vs Clonal R 

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{Mother} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF10F}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{Father} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF40M}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{offspring\PYZus{}identifier} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30\PYZus{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{o}{=} \PY{l+m+mf}{0.8}  
         
         \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{10}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{record} \PY{o}{=} \PY{n}{myvcf}\PY{o}{.}\PY{n}{next}\PY{p}{(}\PY{p}{)}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         
         \PY{n}{RR\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{RL\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{R2\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{D\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{homomorphic\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{heterozygous\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Use the offspring genotypes here, as I want to look at the R[R] and R[L] offspring separately here}
         
         \PY{n}{sample\PYZus{}GTs}
         
         \PY{n}{RR\PYZus{}offspring} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{RL\PYZus{}offspring} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Getting genotype info here again in the same way, but recording R[R] and [R][L] samples separately}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             
             \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{RR\PYZus{}offspring\PYZus{}gts} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{RL\PYZus{}offspring\PYZus{}gts} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             
             \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} count offspring in family}
                 
                 \PY{k}{if} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                     \PY{k}{if} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{RR\PYZus{}offspring}\PY{p}{:}
                             \PY{n}{RR\PYZus{}offspring}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{RL\PYZus{}offspring}\PY{p}{:}
                             \PY{n}{RL\PYZus{}offspring}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} if coverage is high enough, record info of locus}
                 
                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{:}
                     
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Mother}\PY{p}{:}
                         \PY{n}{Mother\PYZus{}called} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Mother\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Mothers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Mothers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
         
                     \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Father}\PY{p}{:}
                         \PY{n}{Father\PYZus{}called} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Father\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Fathers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Fathers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
         
                     \PY{k}{elif} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
         
                         \PY{k}{if} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                                 \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{RR\PYZus{}offspring\PYZus{}gts}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                                 \PY{n}{RR\PYZus{}offspring\PYZus{}gts}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                                 \PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                                 \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{RL\PYZus{}offspring\PYZus{}gts}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                                 \PY{n}{RL\PYZus{}offspring\PYZus{}gts}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                                 \PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
             
             \PY{n}{enough\PYZus{}data} \PY{o}{=} \PY{n+nb+bp}{False}
             
             \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{RR\PYZus{}offspring}\PY{p}{)}\PY{o}{*}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{,} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{RL\PYZus{}offspring}\PY{p}{)}\PY{o}{*}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 
         
                 \PY{c+c1}{\PYZsh{}\PYZsh{} A loci \PYZhy{} R clon L samples}
                 
                 \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{RL\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} B loci \PYZhy{} R clon R samples}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{RR\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} C loci \PYZhy{} R2 loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{l+m+mf}{0.4} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{p}{(}\PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring}\PY{o}{+}\PY{n}{het\PYZus{}RL\PYZus{}offspring}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{o}{+}\PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{R2\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} D loci }
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{!=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{p}{]}\PY{p}{)}\PY{p}{:}
                     \PY{n}{D\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                             
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RL\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RL\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{homomorphic\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{heterozygous\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{not\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} 
                     
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ phasable loci for clonal L (A loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{RL\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ phasable loci for clonal R (B loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{RR\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci variable in female (C loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{R2\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ D loci }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{D\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci homomorphic in this family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{homomorphic\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci heterozygous in both parents}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{heterozygous\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci not phasable}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci with not enough data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}enough\PYZus{}data}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2055 phasable loci for clonal L (A loci)
97 phasable loci for clonal R (B loci)
113 loci variable in female (C loci)
70 D loci 
423 loci homomorphic in this family
267 loci heterozygous in both parents
601 loci not phasable
6256 loci with not enough data

    \end{Verbatim}

    \subsection{Family 39}\label{family-39}

    {[}R{]}L Father x RR Mother, which gives only {[}R{]}R offspring, no RL

So here we are phasing R vs {[}R{]}. A slightly different approach

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{Image}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/FAM\PYZus{}39\PYZus{}schematic.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{900}\PY{p}{)}
\end{Verbatim}

\texttt{\color{outcolor}Out[{\color{outcolor}4}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_37_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    Based on the family schematic above, the following expectations will be
tested in the following code blocks, to identify loci which fit each
category (A, B, C or D).

Test to find the \(a^L\) alleles:

\begin{itemize}
\tightlist
\item
  loci are heterozygous in the father (R{[}L{]})
\item
  loci are homozygous in the mother (RR).
\item
  loci are homozygous in all {[}R{]}R offspring.
\end{itemize}

\(a^L\) allele is then the allele which is specific to the father.

NOTE: this method might be sensitive to null alleles in the mother.

Test to find the \(b^{R1}\) alleles:

\begin{itemize}
\tightlist
\item
  loci are heterozygous in the father (R{[}L{]})
\item
  loci are homozygous in the mother (RR).
\item
  loci are heterozygous in all {[}R{]}R offspring.
\end{itemize}

\(b^{R1}\) allele is then the allele which is specific to the father.

NOTE: this method might be sensitive to null alleles in the father.

Test to find the \(c^{R2}\) alleles (C in figure above):

\begin{itemize}
\tightlist
\item
  loci are homozygous in the father (RL).
\item
  loci are heterozygous in the mother (R{[}L{]})
\item
  loci are heterozygous in 50\% of all {[}R{]}R offspring
\end{itemize}

\(c^{R2}\) allele is then the allele which is specific to the mother.

Test to find the \(d^R\) alleles:

\begin{itemize}
\tightlist
\item
  loci are fixed for alternate genotypes in the mother and father
\item
  loci are heterozygous in all offspring
\end{itemize}

\(d^R\) allele is then the allele which is specific to the mother.

NOTE: this method might be sensitive to null alleles in the father.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{Mother} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF11F}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{Father} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF31M}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{offspring\PYZus{}identifier} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39\PYZus{}}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{offspring\PYZus{}het\PYZus{}threshold} \PY{o}{=} \PY{l+m+mf}{0.8}  
         
         \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{10}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}record = myvcf.next()}
         
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{A\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{B\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{C\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{D\PYZus{}phasable} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{homomorphic\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{heterozygous\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{phasable\PYZus{}for\PYZus{}RR} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Use the offspring genotypes here, as I want to look at the R[R] and R[L] offspring separately here}
         
         \PY{n}{sample\PYZus{}GTs}
         
         \PY{n}{RR\PYZus{}offspring} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} same process as before for getting genotype info for parents and offspring. }
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             
             \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{RR\PYZus{}offspring\PYZus{}gts} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
             \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} count offspring in family}
                 
                 \PY{k}{if} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                     \PY{k}{if} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{RR\PYZus{}offspring}\PY{p}{:}
                             \PY{n}{RR\PYZus{}offspring}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} if coverage is high enough, record info of locus}
                 
                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{:}
                 
                 
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Mother}\PY{p}{:}
                         \PY{n}{mother\PYZus{}found} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Mother\PYZus{}called} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{called}
                         \PY{n}{Mother\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Mothers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Mothers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
         
                     \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{n}{Father}\PY{p}{:}
                         \PY{n}{father\PYZus{}found} \PY{o}{=} \PY{n+nb+bp}{True}
                         \PY{n}{Father\PYZus{}called} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{called}
                         \PY{n}{Father\PYZus{}het} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}
                         \PY{n}{Fathers\PYZus{}GT} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{Fathers\PYZus{}GT\PYZus{}bases} \PY{o}{=} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}
         
                     \PY{k}{elif} \PY{n}{offspring\PYZus{}identifier} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
         
                         \PY{k}{if} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                             \PY{n}{RR\PYZus{}offspring\PYZus{}gts}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{RR\PYZus{}offspring}\PY{p}{:}
                                 \PY{n}{RR\PYZus{}offspring}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                                 \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                                 \PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} Test if enough data is left (includes coverage filter)}
                
             \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}called} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called} \PY{o}{\PYZgt{}} \PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{RR\PYZus{}offspring}\PY{p}{)}\PY{o}{*}\PY{l+m+mf}{0.8}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if parents called and enough offspring called}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Now testing for L phasable loci (A loci)            }
                             
                 \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If mother hom, father het and no (or almost no) offspring heterozygous}
                     
                     \PY{n}{A\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count as phasable. }
                         
                     \PY{c+c1}{\PYZsh{}\PYZsh{} Now get the clonal R allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the allele is not in the mother}
         
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                 
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Now testing for R clone phasable loci (B loci)}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If mother hom, father het and enough offspring are het}
                     
                     \PY{n}{B\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count as phasable. }
                         
                     \PY{c+c1}{\PYZsh{}\PYZsh{} Now get the clonal R allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the allele is not in the mother}
         
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} C loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{l+m+mf}{0.4} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.6}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If mother hom, father het and about half of offspring are het}
                     
                     \PY{n}{C\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count as phasable. }
                         
                     \PY{c+c1}{\PYZsh{}\PYZsh{} Now get the clonal R allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the allele is not in the mother}
         
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Now testing for D loci}
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]} \PY{o}{!=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{offspring\PYZus{}het\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{:} 
                     
                     \PY{n}{D\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}  \PY{c+c1}{\PYZsh{}\PYZsh{} count as phasable. }
                         
                     \PY{c+c1}{\PYZsh{}\PYZsh{} Now get the clonal R allele. }
                     
                     \PY{k}{for} \PY{n}{allele} \PY{o+ow}{in} \PY{n}{Mothers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{allele} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the allele is not in the mother}
         
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{allele}
                             \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Fathers\PYZus{}GT\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                             
                 
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{p}{(}\PY{n}{het\PYZus{}RR\PYZus{}offspring} \PY{o}{/} \PY{n}{N\PYZus{}RR\PYZus{}offspring\PYZus{}called}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{homomorphic\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                 \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{Mother\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{Father\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                     
                     \PY{n}{heterozygous\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{not\PYZus{}phasable} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{not\PYZus{}enough\PYZus{}data} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} 
                     
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ phasable loci for L (A loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{A\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ phasable loci for clonal R (B loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{B\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci variable in female (C loci)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{C\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ D loci}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{D\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci homomorphic in this family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{homomorphic\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci heterozygous in both parents}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{heterozygous\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci had enough data but unphasable}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}phasable}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci with not enough data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{not\PYZus{}enough\PYZus{}data}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
3222 phasable loci for L (A loci)
147 phasable loci for clonal R (B loci)
180 loci variable in female (C loci)
157 D loci
867 loci homomorphic in this family
349 loci heterozygous in both parents
1015 loci had enough data but unphasable
4547 loci with not enough data

    \end{Verbatim}

    \subsection{Combining phased loci and outputting
VCF}\label{combining-phased-loci-and-outputting-vcf}

So we have now have phased loci for R vs L (A loci) and {[}R{]} vs R (B
loci) from several families. The next step is to combine them into a
single VCF, with each individual sample split into its constituent
sub-genomes, with the correct allele placed on each one.

The challenge is how to deal with loci which are phased in one family
but not in another. There is a schematic below for reference when
considering this problem.

The easiest thing to do would be to output only loci phased in all
families. For example, on the schematic below, R vs L phased loci phased
in all families would be \(A^1\) loci, which must have arisen in the
branches leading to the L or R lineages. However these would not give us
any information on variation within these lineages. Thus I need to
include loci which have been phased for R vs L (and R vs {[}R{]}) within
each family, in order to be able to characterise variation within R and
L lineages. This raises some theoretical challenges however - for
example, how do I deal with a locus which is phased for R vs L in Family
1, which was not phased in Family 2? These would be \(A^2\) loci, or
\(C/D\) loci. Equally, how do I deal with loci phased for R vs {[}R{]}
in only one family and not another (i.e. \(C/D\) or \(B\) loci).

I will deal with these cases one by one when creating the VCF.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}591}]:} \PY{n}{Image}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/Phasing\PYZus{}schematic\PYZus{}color\PYZus{}coordinated.png}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{900}\PY{p}{)}
\end{Verbatim}

\texttt{\color{outcolor}Out[{\color{outcolor}591}]:}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_41_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    \subsection{Strategy:}\label{strategy}

I will first curate the sets of loci (A, B, C and D) separately before
including them one by one in the final dataset. This way I can check the
structure that each locus category brings out and troubleshoot along the
way. Note that I will not use family 39 for this, as those loci were
inferred only from the father's heterozygous call in that family, which
will be unreliable.

\subsubsection{For A-loci}\label{for-a-loci}

For each locus that has been phased for R vs L in each RL family, do two
checks:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  is it phased in another family, and if so do the phasings agree
\item
  is it is phased in only one family.
\end{enumerate}

If a locus passes both of these tests it makes it into the final
dataset. I then output a new phased VCF for these loci, where each
sample is represented twice - once for each constituent sub-genome (in
doubled-haploid form). The structure among the phased subgenomes is then
visualised using a simple PCA.

Below is a quick venn diagram to get a handle on how much sharing of
phased A-loci there is between RL families.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{k+kn}{import} \PY{n+nn}{venn}
         \PY{n}{labels} \PY{o}{=} \PY{n}{venn}\PY{o}{.}\PY{n}{get\PYZus{}labels}\PY{p}{(}\PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{number}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{venn}\PY{o}{.}\PY{n}{venn4}\PY{p}{(}\PY{n}{labels}\PY{p}{,} \PY{n}{names}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{fig}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/home/djeffrie/anaconda3/envs/py27/lib/python2.7/site-packages/matplotlib/figure.py:418: UserWarning: matplotlib is currently using a non-GUI backend, so cannot show the figure
  "matplotlib is currently using a non-GUI backend, "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    So the loci right in the centre must be true A1 loci. Those private to
each family are probably the A2 loci. Those phased in two or three may
be A2 loci, or may be A1 loci which just drop out in one or two families
because of missing data for example.

    In preliminary rounds of the A-loci curation, a curious pattern was
emerging. The phased R genomes from RL samples for family 27 were
falling apart from the phased R genomes of their RR siblings.
Furthermore these "divergent" R's from the RLs of family 27 were
clustering with the R's from family 25's RL offspring.

It was suspected that this was due to some artifact of the
data/analyses. So below I go through the steps I used to get to the
bottom of this problem.

In the scripting cell below, I first isolate the A1 loci, on adding
these to the dataset, as expected (and not shown below) the only
resulting structure between subgenomes was between the R's and L's. With
variation within these groups being minimal and due to noise in data
presence/absence.

I then add A2 loci, that is, loci which have been phased in one family
only. This is where problems occur.

Below I add these loci, with no extra sanity checks . . .

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} A\PYZhy{}loci curation}
         
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         
         \PY{n}{RL\PYZus{}fams} \PY{o}{=} \PY{p}{[} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{]}
         
         \PY{n}{phased\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{aL\PYZus{}alleles\PYZus{}in\PYZus{}RRs} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{aL\PYZus{}alleles\PYZus{}homozygous} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}phased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{KEPT} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{Kept\PYZus{}A\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{A1\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{A2\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} CHECK for A1 loci \PYZhy{} if phased in more than one family, are the phasings for this locus consistent?}
             \PY{c+c1}{\PYZsh{}\PYZsh{} loop over each family phasing dictionary, get the a and aL alleles and check that they are consistent.}
             
             \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
             \PY{n}{a} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{aL} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False} 
             \PY{n}{families\PYZus{}phased} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{aL\PYZus{}behaviour\PYZus{}OK} \PY{o}{=} \PY{n+nb+bp}{False}
             
             \PY{k}{for} \PY{n}{family} \PY{o+ow}{in} \PY{n}{RL\PYZus{}fams}\PY{p}{:}
                 
                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                     \PY{n}{families\PYZus{}phased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
                     \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{True}  \PY{c+c1}{\PYZsh{}\PYZsh{} if incosnsitencies arise, this will change to false and the locus will not be used. }
                     
                     \PY{k}{if} \PY{n}{a} \PY{o}{==} \PY{n}{aL} \PY{o}{==} \PY{n+nb+bp}{None}\PY{p}{:}
                         \PY{n}{a} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{aL} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                     
                     \PY{k}{elif} \PY{o+ow}{not} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{a}\PY{p}{,} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{aL}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False}
                         
                
             \PY{c+c1}{\PYZsh{}\PYZsh{} Check 2) \PYZhy{} if phased in only one family, check that the aL allele is not homozygous in too many offspring, and not present in too many RR samples.             }
                         
             \PY{k}{if} \PY{n}{record\PYZus{}phased}\PY{p}{:}
                 \PY{n}{phased\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{n}{samples\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{aL\PYZus{}in\PYZus{}RRs} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{aL\PYZus{}homozygous} \PY{o}{=} \PY{l+m+mi}{0}
                
                 
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
         
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                         \PY{n}{samples\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         
                         \PY{k}{if} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                             \PY{k}{if} \PY{n}{aL} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                                 \PY{n}{aL\PYZus{}in\PYZus{}RRs} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{aL}\PY{p}{,} \PY{n}{aL}\PY{p}{)}\PY{p}{:}
                             \PY{n}{aL\PYZus{}homozygous} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
             \PY{c+c1}{\PYZsh{}\PYZsh{} Now use the results of these two checks to decide whether to keep the locus or not. }
             
             \PY{k}{if} \PY{n}{families\PYZus{}phased} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                 \PY{n}{multiphased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{if} \PY{n}{multiphased\PYZus{}ok}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus is phased in more than one family and the phasings agree.}
                     \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[} \PY{n}{aL\PYZus{}in\PYZus{}RRs} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{aL\PYZus{}homozygous} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If the L allele is never in RR samples and never homozygous. }
                     
                         \PY{n}{A1\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} 
         
                         \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                         \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{aL}
                         \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{a}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} If the locus is only phased in one family }
             
             \PY{k}{elif} \PY{n}{families\PYZus{}phased} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                 \PY{n}{A2\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                 \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}     
                 \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                 \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{aL}
                 \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{a}
                     
         
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ records phased}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{phased\PYZus{}count}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ are phased in more than one RL family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have matching phasings across families}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased\PYZus{}ok}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have L alleles which are never homozygous in RR samples (A1 loci )}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{A1\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ A2 loci found}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{A2\PYZus{}loci}
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ A loci kept}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{KEPT}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
4006 records phased
Of which 2085 are phased in more than one RL family
Of which True have matching phasings across families
Of which 1228 have L alleles which are never homozygous in RR samples (A1 loci )
1921 A2 loci found
3149 A loci kept

    \end{Verbatim}

    \subsubsection{Making the VCF}\label{making-the-vcf}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} getting rid of some samples that have a lot of missing data, and obscure the signal in the PCA}
         
         \PY{n}{discards} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{25\PYZus{}2013\PYZus{}JUV17}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27\PYZus{}2013\PYZus{}JUV13}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27\PYZus{}2013\PYZus{}JUV14}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41\PYZus{}2013\PYZus{}JUV12}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41\PYZus{}2013\PYZus{}JUV16}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41\PYZus{}2013\PYZus{}JUV17}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27\PYZus{}2013\PYZus{}JUV02}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27\PYZus{}2013\PYZus{}JUV021}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27\PYZus{}2013\PYZus{}JUV022}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}clone\PYZus{}GMP\PYZus{}01\PYZus{}05\PYZus{}C17A}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}clone\PYZus{}GMP\PYZus{}01\PYZus{}05\PYZus{}C30B}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}clone\PYZus{}GMP\PYZus{}01\PYZus{}05\PYZus{}C30C}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ly\PYZus{}clone\PYZus{}16cz4wf14m\PYZus{}C45A}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ly\PYZus{}clone\PYZus{}16cz4wf15m\PYZus{}C46B}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}clone\PYZus{}GMP\PYZus{}01\PYZus{}05\PYZus{}C17C}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}clone\PYZus{}GMU\PYZus{}03\PYZus{}02B\PYZus{}C31B2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}clonal\PYZus{}GMP\PYZus{}05\PYZus{}01\PYZus{}C25A}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}}
                     \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}clonal\PYZus{}GMP\PYZus{}05\PYZus{}01\PYZus{}C25B}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{c+c1}{\PYZsh{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}732}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{n}{vcf\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie//Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1.vcf}\PY{l+s+s2}{\PYZdq{}}
          \PY{n}{outvcf} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW3\PYZus{}haps.vcf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{10}
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} write headers}
          
          \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n+nb}{open}\PY{p}{(}\PY{n}{hap\PYZus{}vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}\PYZsh{}FORMAT=\PYZlt{}ID=GL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                  \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{line}\PY{p}{)}
          
          \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{False}
          
          \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} 
          
          \PY{n}{discordant\PYZus{}A\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}A\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{loci\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
          
          
          \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for each locus}
          
              \PY{c+c1}{\PYZsh{}\PYZsh{} Set REF and ALT alleles for the record (sexual R always REF)}
              
              \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
              
              \PY{n}{sample\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{sample\PYZus{}fields} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              
              \PY{n}{N\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
              
              
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}    FOR A\PYZhy{}LOCI    \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              
              
              \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                  
                  \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
          
                  \PY{n}{R\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  \PY{n}{L\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  
                  \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                      
                      \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                      
                          \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                  
                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                       
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
          
                      \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                          \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                          \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                          
                          \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                          \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                          
                          \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                          \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                          \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                      
          
                      
                      \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
          
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                          \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
          
                          \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
          
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                  
                  \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                      \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                      \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                  
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                  
                  \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{record}\PY{o}{.}\PY{n}{num\PYZus{}called}\PY{o}{*}\PY{l+m+mf}{0.25}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                          
                      \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{REF}\PY{p}{,} \PY{n}{ALT}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                      \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
          
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              \PY{k}{else}\PY{p}{:}
                  \PY{k}{pass} 
          
          \PY{n}{outvcf}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci dropped due to missing data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{loci\PYZus{}dropped}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
307 loci dropped due to missing data

    \end{Verbatim}

    \subsubsection{Now making the PCA}\label{now-making-the-pca}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PYZpc{}\PYZpc{}bash
        
        \PY{n+nv}{wd}\PY{o}{=}/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted  \PY{c+c1}{\PYZsh{}\PYZsh{} just change this line}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All data }
        sed \PY{l+s+s1}{\PYZsq{}s/\PYZus{}/\PYZhy{}/g\PYZsq{}} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW3\PYZus{}haps.vcf \PYZgt{} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf
        
        \PYZti{}/Programs/plink\PYZus{}linux\PYZus{}x86\PYZus{}64/plink \PYZhy{}\PYZhy{}vcf \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf \PYZhy{}\PYZhy{}recode A \PYZhy{}\PYZhy{}allow\PYZhy{}extra\PYZhy{}chr \PYZhy{}out \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{o}{\PYZpc{}\PYZpc{}}R
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Load packages and functions needed}
        
        \PY{k+kn}{library}\PY{p}{(}adegenet\PY{p}{)}
        \PY{k+kn}{library}\PY{p}{(}ggplot2\PY{p}{)}
        \PY{k+kn}{source}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZti{}/Dropbox/My\PYZus{}Dropbox\PYZus{}Scripts/R/My\PYZus{}functions/Sex\PYZus{}sorter\PYZus{}PCA\PYZus{}plotting\PYZus{}function.R\PYZdq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Reading in the data \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        \PY{k+kp}{setwd}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted\PYZdq{}}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All SNPs }
        alldata \PY{o}{\PYZlt{}\PYZhy{}} read.PLINK\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink.raw\PYZsq{}}\PY{p}{,} chunkSize\PY{o}{=}\PY{l+m}{1000}\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores\PY{o}{=}\PY{l+m}{1}\PY{p}{,} saveNbAlleles\PY{o}{=}\PY{n+nb+bp}{T}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Running PCA \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        pca1 \PY{o}{\PYZlt{}\PYZhy{}} glPca\PY{p}{(}alldata\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores \PY{o}{=} \PY{l+m}{6}\PY{p}{,} nf \PY{o}{=} \PY{l+m}{5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}739}]:} \PY{o}{\PYZpc{}\PYZpc{}}R \PY{o}{\PYZhy{}}w \PY{l+m}{50} \PY{o}{\PYZhy{}}h \PY{l+m}{50} \PY{o}{\PYZhy{}}u cm
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} Plotting the PCAs using the Sex\PYZus{}sorter function.}
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} Sex information \PYZhy{} just a two column text file with the sample name in the first column and the sex (M or F) in the second column. Its for labelling the PCA}
          sexes \PY{o}{\PYZlt{}\PYZhy{}} read.delim\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/popmap\PYZus{}pops\PYZus{}only\PYZus{}KEPT.txt\PYZdq{}}\PY{p}{,} header \PY{o}{=} \PY{n+nb+bp}{F}\PY{p}{)}
          
          Sex\PYZus{}sorter\PY{p}{(}pca1\PY{p}{,}   \PY{c+c1}{\PYZsh{}\PYZsh{} PCA object}
                     sexes\PY{p}{,}  \PY{c+c1}{\PYZsh{}\PYZsh{} sex\PYZus{}info file}
                     \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{1}\PY{p}{,}\PY{l+m}{2}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} which components to plotb}
                     Title \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Phased Hybridogens\PYZus{}all samples\PYZus{}PC\PYZus{}1\PYZus{}2\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} plot title}
                     xtitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC3\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} X axis title}
                     ytitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC4\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Y axis title }
                     Palette \PY{o}{=} rainbow\PY{p}{(}\PY{l+m}{6}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Colours to use}
                     func\PYZus{}cex \PY{o}{=} \PY{l+m}{5}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZsh{} Size of points and text in plots)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_53_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    So you see this pattern with the R genomes from family 25 falling a long
way out from the other Rs in the top left here. And the weird thing is
that the Rs from RL samples in family 27 cluster with them, while the
R's from RR samples in family 27 cluster closer to the other Rs. This is
clearly wrong, as the R's from the RL and RR offspring of family 27 both
come from the same mother. Thus they should be pretty much identical,
give or take a bit of recombination in the mother (regardless, they
should form one continuous cluster here).

So, after much trial and error exploring these A2 loci I discovered that
the loci driving this signal in the PCA are loci which are all
homozygous for the L allele in these family 27 RL offpsring (in the
original VCF). Now, by definitition, these loci could not be phased in
family 27, they were in fact phased in other RL families (see Venn
diagram below - problem loci labelled as "weird loci").

The only explanation that I can think of is that these loci contain null
alleles in the female of family 27 (note that it is the same female as
used in the family 25 cross). So say a locus was phased only in family
30 for RL. If that locus was an A2 locus, the L allele should never be
found in homozygous state in any family here. Now consider that the
female in family 27 (and 25) comes from a different population. There
will undoubtably be variation in the RADseq data between these
population, and one common form of RADseq variation is null alleles
(i.e. an allele drops out in one population but not another). So, if at
the locus which was phased in family 30, there was a null allele in the
R genome of family 27, but the L allele was intact, RL samples in family
27 would be hemizygous for the L allele and so be assigned a genotype of
LL in RADseq SNP calling. RR samples from family 27 would be hemizygous
for the from the father, which presumably doesn't have the null allele
as it is from an entirely separate population.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}519}]:} \PY{k+kn}{import} \PY{n+nn}{venn}
          \PY{n}{labels} \PY{o}{=} \PY{n}{venn}\PY{o}{.}\PY{n}{get\PYZus{}labels}\PY{p}{(}\PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{weird\PYZus{}loci\PYZus{}list}\PY{p}{]}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{number}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{venn}\PY{o}{.}\PY{n}{venn5}\PY{p}{(}\PY{n}{labels}\PY{p}{,} \PY{n}{names}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Weird loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{fig}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_55_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    So the way of controlling for these loci is simply to add further checks
to the curation of the A-loci. Specifically I will now impose the filter
that loci which are phased for RL in one or more families, can never be
homozygous for the L allele in any family (give or take for some missed
heterozygous calls)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} A\PYZhy{}loci curation}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         
         \PY{n}{RL\PYZus{}fams} \PY{o}{=} \PY{p}{[} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{]}
         
         \PY{n}{phased\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{aL\PYZus{}alleles\PYZus{}in\PYZus{}RRs} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{aL\PYZus{}alleles\PYZus{}homozygous} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}phased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{KEPT} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{Kept\PYZus{}A\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{A1\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{A2\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{weird\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{weird\PYZus{}loci\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{CD\PYZus{}loci} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} CHECK for A1 loci \PYZhy{} if phased in more than one family, are the phasings for this locus consistent?}
             \PY{c+c1}{\PYZsh{}\PYZsh{} loop over each family phasing dictionary, get the a and aL alleles and check that they are consistent.}
             
             \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
             \PY{n}{a} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{aL} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False} 
             \PY{n}{families\PYZus{}phased} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{aL\PYZus{}behaviour\PYZus{}OK} \PY{o}{=} \PY{n+nb+bp}{False}
             
             \PY{k}{for} \PY{n}{family} \PY{o+ow}{in} \PY{n}{RL\PYZus{}fams}\PY{p}{:}
                 
                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                     \PY{n}{families\PYZus{}phased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
                     \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{True}  \PY{c+c1}{\PYZsh{}\PYZsh{} if incosnsitencies arise, this will change to false and the locus will not be used. }
                     
                     \PY{k}{if} \PY{n}{a} \PY{o}{==} \PY{n}{aL} \PY{o}{==} \PY{n+nb+bp}{None}\PY{p}{:}
                         \PY{n}{a} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{aL} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                     
                     \PY{k}{elif} \PY{o+ow}{not} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{a}\PY{p}{,} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{A\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{aL}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False}
                         
                
             \PY{c+c1}{\PYZsh{}\PYZsh{} Check 2) \PYZhy{} if phased in only one family, check that the aL allele is not homozygous in too many offspring, and not present in too many RR samples.             }
                         
             \PY{k}{if} \PY{n}{record\PYZus{}phased}\PY{p}{:}
                 \PY{n}{phased\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{n}{samples\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{aL\PYZus{}in\PYZus{}RRs} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{aL\PYZus{}homozygous} \PY{o}{=} \PY{l+m+mi}{0}
                
                 
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
         
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                         \PY{n}{samples\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         
                         \PY{k}{if} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                             \PY{k}{if} \PY{n}{aL} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
                                 \PY{n}{aL\PYZus{}in\PYZus{}RRs} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{aL}\PY{p}{,} \PY{n}{aL}\PY{p}{)}\PY{p}{:}
                             \PY{n}{aL\PYZus{}homozygous} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
             \PY{c+c1}{\PYZsh{}\PYZsh{} Now use the results of these two checks to decide whether to keep the locus or not. }
             
             \PY{k}{if} \PY{n}{families\PYZus{}phased} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                 \PY{n}{multiphased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{if} \PY{n}{multiphased\PYZus{}ok}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus is phased in more than one family and the phasings agree.}
                     \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[} \PY{n}{aL\PYZus{}in\PYZus{}RRs} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{aL\PYZus{}homozygous} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If the L allele is never in RR samples and never homozygous. }
                     
                         \PY{n}{A1\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} 
         
                         \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                         \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{aL}
                         \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{a}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} If the locus is only phased in one family }
             
             \PY{k}{elif} \PY{n}{families\PYZus{}phased} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                 \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[} \PY{n}{aL\PYZus{}in\PYZus{}RRs} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{aL\PYZus{}homozygous} \PY{o}{\PYZlt{}} \PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the L locus is never in RR samples and it is (almost) never homozygous, must be an A2 locus}
                     \PY{n}{A2\PYZus{}loci} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                     \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}     
                     \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                     \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{aL}
                     \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{a}
                     
         
             
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ records phased}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{phased\PYZus{}count}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ are phased in more than one RL family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have matching phasings across families}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased\PYZus{}ok}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have L alleles which are never homozygous in RR samples (A1 loci )}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{A1\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ A2 loci found}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{A2\PYZus{}loci}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ weird loci found}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{weird\PYZus{}loci}
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ A loci kept}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{KEPT}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2514 records phased
Of which 1352 are phased in more than one RL family
Of which True have matching phasings across families
Of which 79 have L alleles which are never homozygous in RR samples (A1 loci )
260 A2 loci found
0 weird loci found
339 A loci kept

    \end{Verbatim}

    So now I will remake the VCF and replot the PCA.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}742}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{n}{vcf\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie//Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1.vcf}\PY{l+s+s2}{\PYZdq{}}
          \PY{n}{outvcf} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW3\PYZus{}haps.vcf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{10}
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} write headers}
          
          \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n+nb}{open}\PY{p}{(}\PY{n}{hap\PYZus{}vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}\PYZsh{}FORMAT=\PYZlt{}ID=GL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                  \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{line}\PY{p}{)}
          
          \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{False}
          
          \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} 
          
          \PY{n}{discordant\PYZus{}A\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}A\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{loci\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
          
          
          \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for each locus}
          
              \PY{c+c1}{\PYZsh{}\PYZsh{} Set REF and ALT alleles for the record (sexual R always REF)}
              
              \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
              
              \PY{n}{sample\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{sample\PYZus{}fields} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              
              \PY{n}{N\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
              
              
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}    FOR A\PYZhy{}LOCI    \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              
              
              \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                  
                  \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
          
                  \PY{n}{R\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  \PY{n}{L\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  
                  \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                      
                      \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                      
                          \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                  
                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                       
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
          
                      \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                          \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                          \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                          
                          \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                          \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                          
                          \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                          \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                          \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                      
          
                      
                      \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
          
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                          \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
          
                          \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
          
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                  
                  \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                      \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                      \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                  
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                  
                  \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{record}\PY{o}{.}\PY{n}{num\PYZus{}called}\PY{o}{*}\PY{l+m+mf}{0.25}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                          
                      \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{REF}\PY{p}{,} \PY{n}{ALT}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                      \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
          
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              \PY{k}{else}\PY{p}{:}
                  \PY{k}{pass} 
          
          \PY{n}{outvcf}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci dropped due to missing data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{loci\PYZus{}dropped}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
92 loci dropped due to missing data

    \end{Verbatim}

    \subsubsection{PCA}\label{pca}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PYZpc{}\PYZpc{}bash
        
        \PY{n+nv}{wd}\PY{o}{=}/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted  \PY{c+c1}{\PYZsh{}\PYZsh{} just change this line}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All data }
        sed \PY{l+s+s1}{\PYZsq{}s/\PYZus{}/\PYZhy{}/g\PYZsq{}} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW3\PYZus{}haps.vcf \PYZgt{} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf
        
        \PYZti{}/Programs/plink\PYZus{}linux\PYZus{}x86\PYZus{}64/plink \PYZhy{}\PYZhy{}vcf \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf \PYZhy{}\PYZhy{}recode A \PYZhy{}\PYZhy{}allow\PYZhy{}extra\PYZhy{}chr \PYZhy{}out \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{o}{\PYZpc{}\PYZpc{}}R
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Load packages and functions needed}
        
        \PY{k+kn}{library}\PY{p}{(}adegenet\PY{p}{)}
        \PY{k+kn}{library}\PY{p}{(}ggplot2\PY{p}{)}
        \PY{k+kn}{source}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZti{}/Dropbox/My\PYZus{}Dropbox\PYZus{}Scripts/R/My\PYZus{}functions/Sex\PYZus{}sorter\PYZus{}PCA\PYZus{}plotting\PYZus{}function.R\PYZdq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Reading in the data \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        \PY{k+kp}{setwd}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted\PYZdq{}}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All SNPs }
        alldata \PY{o}{\PYZlt{}\PYZhy{}} read.PLINK\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink.raw\PYZsq{}}\PY{p}{,} chunkSize\PY{o}{=}\PY{l+m}{1000}\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores\PY{o}{=}\PY{l+m}{1}\PY{p}{,} saveNbAlleles\PY{o}{=}\PY{n+nb+bp}{T}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Running PCA \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        pca1 \PY{o}{\PYZlt{}\PYZhy{}} glPca\PY{p}{(}alldata\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores \PY{o}{=} \PY{l+m}{6}\PY{p}{,} nf \PY{o}{=} \PY{l+m}{5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}745}]:} \PY{o}{\PYZpc{}\PYZpc{}}R \PY{o}{\PYZhy{}}w \PY{l+m}{50} \PY{o}{\PYZhy{}}h \PY{l+m}{50} \PY{o}{\PYZhy{}}u cm
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} Plotting the PCAs using the Sex\PYZus{}sorter function.}
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} Sex information \PYZhy{} just a two column text file with the sample name in the first column and the sex (M or F) in the second column. Its for labelling the PCA}
          sexes \PY{o}{\PYZlt{}\PYZhy{}} read.delim\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/popmap\PYZus{}pops\PYZus{}only\PYZus{}KEPT.txt\PYZdq{}}\PY{p}{,} header \PY{o}{=} \PY{n+nb+bp}{F}\PY{p}{)}
          
          Sex\PYZus{}sorter\PY{p}{(}pca1\PY{p}{,}   \PY{c+c1}{\PYZsh{}\PYZsh{} PCA object}
                     sexes\PY{p}{,}  \PY{c+c1}{\PYZsh{}\PYZsh{} sex\PYZus{}info file}
                     \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{1}\PY{p}{,}\PY{l+m}{2}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} which components to plotb}
                     Title \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Phased Hybridogens\PYZus{}all samples\PYZus{}PC\PYZus{}1\PYZus{}2\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} plot title}
                     xtitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC3\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} X axis title}
                     ytitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC4\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Y axis title }
                     Palette \PY{o}{=} rainbow\PY{p}{(}\PY{l+m}{6}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Colours to use}
                     func\PYZus{}cex \PY{o}{=} \PY{l+m}{5}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZsh{} Size of points and text in plots)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_63_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    So that gets rid of the signal pulling the 25 and 27 RL R's out of the
pack.

Now I want to add in real variation between the R's. That is, C and D
locus categories.

Same strategy as before, curate the locus set first, then add to the
final dataset.

So what are our expectations for a C-locus. Refer again to the tree
schematic.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  C loci should never be homozygous in an RL sample.
\item
  C loci could be homozygous in an \([R]R\) sample, depending on which
  branch the C locus polymorphism originated and from which branch the
  \([R]\) genome came from. E.g. on the tree schematic, the \([R]^2\)
  genome branched off from the \(R^2\) lineage, if a polymorphism arose
  on the branch leading to these two R lineages, an \([R]^1R^2\) sample
  could be homozygous for that locus. It would not be able to be phased
  in that family, but could potentially be phased in another. So I will
  allow C loci to be homozygous in {[}R{]}R or RR samples but not RL
  samples. However, I have to again be careful of the null alleles
  between the two populations here.
\end{enumerate}

So below I will perform two checks again:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  Is the locus was phased in more than one family, and if so, if they
  are congruent?\\
\item
  If phased in only one family, is the R allele never homozygous in RL
  samples.\\
\item
  There is one more subtle issue, that is, a locus with a polymorphism
  in the mother, could be heterozygous in an \([R]R\) sample from
  another family where it was not phased but the c\_R2 allele could be
  on the \([R]\) not the \(R\). This is however, detectable, as if the
  c\_R2 allele was on the \([R]\) subgenome, it would be in every
  \([R]\) offspring from that family. While, if it were on the \(R\)
  subgenome, it would be passed only to half of the offspring. So this
  will be the third check
\end{enumerate}

Lets take a look at how the phased C loci are shared among families

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}600}]:} \PY{k+kn}{import} \PY{n+nn}{venn}
          \PY{n}{labels} \PY{o}{=} \PY{n}{venn}\PY{o}{.}\PY{n}{get\PYZus{}labels}\PY{p}{(}\PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{number}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{venn}\PY{o}{.}\PY{n}{venn5}\PY{p}{(}\PY{n}{labels}\PY{p}{,} \PY{n}{names}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{fig}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_65_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    So most of these loci are phased only in one family, which I suppose is
to be expected. There is some overlap, normally between one or two
families only.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} C\PYZhy{}loci curation}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         
         \PY{n}{All\PYZus{}fams} \PY{o}{=} \PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{]}
         
         \PY{n}{phased\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}phased} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{c\PYZus{}R2\PYZus{}alleles\PYZus{}homozygous\PYZus{}in\PYZus{}RL} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}phased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{C\PYZus{}loci\PYZus{}multiphased\PYZus{}kept} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{C\PYZus{}loci\PYZus{}single\PYZus{}kept} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphase\PYZus{}not\PYZus{}on\PYZus{}Rclon} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}not\PYZus{}on\PYZus{}Rclon} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{KEPT} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{Kept\PYZus{}C\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} CHECK for C loci \PYZhy{} if phased in more than one family, are the phasings for this locus consistent?}
             \PY{c+c1}{\PYZsh{}\PYZsh{} loop over each family phasing dictionary, get the c and c\PYZus{}R2 alleles and check that they are consistent.}
             
             \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
             \PY{n}{c} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{c\PYZus{}R2} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False} 
             \PY{n}{families\PYZus{}phased} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{aL\PYZus{}behaviour\PYZus{}OK} \PY{o}{=} \PY{n+nb+bp}{False}
             
             \PY{k}{for} \PY{n}{family} \PY{o+ow}{in} \PY{n}{All\PYZus{}fams}\PY{p}{:}
                 
                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                     \PY{n}{families\PYZus{}phased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
                     \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{True}  \PY{c+c1}{\PYZsh{}\PYZsh{} if incosnsitencies arise, this will change to false and the locus will not be used. }
                     
                     \PY{k}{if} \PY{n}{c} \PY{o}{==} \PY{n}{c\PYZus{}R2} \PY{o}{==} \PY{n+nb+bp}{None}\PY{p}{:}
                         \PY{n}{c} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{c\PYZus{}R2} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                     
                     \PY{k}{elif} \PY{o+ow}{not} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{c}\PY{p}{,} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{C\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{c\PYZus{}R2}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False}
                         
                
             \PY{c+c1}{\PYZsh{}\PYZsh{} Check 2) \PYZhy{} if phased in only one family, check that the c\PYZus{}R2 allele is not homozygous in RL offspring (over the threshold. **Note that a couple of missed heterozygous calls can be due to low coverage, }
             \PY{c+c1}{\PYZsh{}\PYZsh{} and can be tolerated, but if many offspring don\PYZsq{}t are homozygous for the c\PYZus{}R2 allele, this is indicative of a null allele and the locus should not be used).             }
                         
             \PY{k}{if} \PY{n}{record\PYZus{}phased}\PY{p}{:}
                 \PY{n}{phased\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{c\PYZus{}R2\PYZus{}homozygous\PYZus{}RL} \PY{o}{=} \PY{l+m+mi}{0}
                
                 
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
         
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                         \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2}\PY{p}{,} \PY{n}{c\PYZus{}R2}\PY{p}{)}\PY{p}{:}
                             \PY{n}{c\PYZus{}R2\PYZus{}homozygous\PYZus{}RL} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
             
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Check 3) \PYZhy{} for each family, is the c\PYZus{}R2 allele ever heterozygous in all R[R] offspring of the same family? If so it is likely on the [R] in that family (having been phased in a different family), and so can\PYZsq{}t be used. }
                 
                 \PY{n}{R\PYZus{}Rclon\PYZus{}families} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 
                 \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                 
         
                 \PY{k}{for} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{R\PYZus{}Rclon\PYZus{}families}\PY{p}{:}
                     
                     \PY{n}{called\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{0}
                     \PY{n}{het\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{0}
                     
                     \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{and} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                             
                             \PY{n}{called\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het} \PY{o+ow}{and} \PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c}\PY{p}{,} \PY{n}{c\PYZus{}R2}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2}\PY{p}{,} \PY{n}{c}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                                     
                                 \PY{n}{het\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{if} \PY{n}{called\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                         \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{n}{het\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{/} \PY{n}{called\PYZus{}R\PYZus{}Rclon\PYZus{}samples}
                     
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                         
                 \PY{c+c1}{\PYZsh{}print record.ID, \PYZdq{}25\PYZdq{}, R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}25\PYZdq{}], \PYZdq{}27\PYZdq{}, R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}27\PYZdq{}], \PYZdq{}30\PYZdq{}, R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}30\PYZdq{}],\PYZdq{}39\PYZdq{},  R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}39\PYZdq{}], \PYZdq{}41\PYZdq{}, R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}41\PYZdq{}]}
             
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} Now use the results of these three checks to decide whether to keep the locus or not. }
             
             \PY{k}{if} \PY{n}{families\PYZus{}phased} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                 \PY{n}{multiphased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{if} \PY{n}{multiphased\PYZus{}ok}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus is phased in more than one family and the phasings agree.}
                     \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} If the locus is never heterozygous in more than 70\PYZpc{} of [R]R samples (thus can\PYZsq{}t be on the [R])}
                     \PY{k}{if} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7}\PY{p}{:}
                             
                         \PY{n}{multiphase\PYZus{}not\PYZus{}on\PYZus{}Rclon} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{if} \PY{n}{c\PYZus{}R2\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If the c\PYZus{}R2 allele is never in RL samples and never homozygous. }
                     
                         \PY{n}{C\PYZus{}loci\PYZus{}multiphased\PYZus{}kept} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} 
                         
                     \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{,}
                             \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{,}
                             \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{,}
                             \PY{n}{c\PYZus{}R2\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If the c\PYZus{}R2 allele is never in RL samples and never homozygous. }
                     
                             
                         \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                         \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{c\PYZus{}R2}
                         \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{c}
                         
                         \PY{k}{if} \PY{n}{c\PYZus{}R2\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If the c\PYZus{}R2 allele is never in RL samples and never homozygous. }
                     
                             \PY{n}{C\PYZus{}loci\PYZus{}multiphased\PYZus{}kept} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} 
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} If the locus is only phased in one family }
             
             \PY{k}{elif} \PY{n}{families\PYZus{}phased} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                 
                 \PY{n}{single\PYZus{}phased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{if} \PY{n}{c\PYZus{}R2\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the c\PYZus{}R2 locus is never in RL samples and it is (almost) never homozygous, must be an C locus}
                     
                     \PY{n}{C\PYZus{}loci\PYZus{}single\PYZus{}kept} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                 \PY{c+c1}{\PYZsh{}\PYZsh{} If the locus is never heterozygous in more than 70\PYZpc{} of [R]R samples (thus can\PYZsq{}t be on the [R])}
                 \PY{k}{if} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7}\PY{p}{:}
                             
                     \PY{n}{single\PYZus{}not\PYZus{}on\PYZus{}Rclon} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}    
                     
                 \PY{k}{if} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{c\PYZus{}R2\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
         
                     \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}     
                     \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                     \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{c\PYZus{}R2}
                     \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{c}
                     
         
             
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ records phased}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{phased\PYZus{}count}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ are phased in more than one family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have matching phasings across families}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased\PYZus{}ok\PYZus{}count}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have c\PYZus{}R2 alleles which are never homozygous in RL samples}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{C\PYZus{}loci\PYZus{}multiphased\PYZus{}kept}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{and }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have c\PYZus{}R2 alleles which are never heterozygous in all [R] samples in a family (i.e. not on the [R]) }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphase\PYZus{}not\PYZus{}on\PYZus{}Rclon}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci are phased in only one family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}}  \PY{n}{single\PYZus{}phased}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have c\PYZus{}R2 alleles which are never homozygous in RL samples}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{C\PYZus{}loci\PYZus{}single\PYZus{}kept}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{and }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have c\PYZus{}R2 alleles which are never heterozygous in all [R] samples in a family (i.e. not on the [R]) }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{single\PYZus{}not\PYZus{}on\PYZus{}Rclon}
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ C loci kept (pass all checks)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{KEPT}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
387 records phased
44 are phased in more than one family
Of which 44 have matching phasings across families
70 have c\_R2 alleles which are never homozygous in RL samples
and 35 have c\_R2 alleles which are never heterozygous in all [R] samples in a family (i.e. not on the [R]) 
343 loci are phased in only one family
Of which 220 have c\_R2 alleles which are never homozygous in RL samples
and 267 have c\_R2 alleles which are never heterozygous in all [R] samples in a family (i.e. not on the [R]) 
192 C loci kept (pass all checks)

    \end{Verbatim}

    So not a bad number retained - if they are real and able to be kept they
should add some signal to the PCA. The problem I have with these loci is
that I don't know on which chromosome the SNP was in the mother. I think
I will have to just randomise this (or at least alternate) when I assign
the SNP to the subgenomes from the mothers.

So below I will take the same script for making the VCF as above, but
add a section for dealing with C loci to it.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}748}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{n}{vcf\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie//Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1.vcf}\PY{l+s+s2}{\PYZdq{}}
          \PY{n}{outvcf} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW3\PYZus{}haps.vcf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{10}
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} write headers}
          
          \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n+nb}{open}\PY{p}{(}\PY{n}{hap\PYZus{}vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}\PYZsh{}FORMAT=\PYZlt{}ID=GL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                  \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{line}\PY{p}{)}
          
          \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{False}
          
          \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} 
          
          \PY{n}{discordant\PYZus{}A\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}A\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{discordant\PYZus{}B\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}B\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{discordant\PYZus{}C\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}C\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{discordant\PYZus{}D\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}D\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{loci\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
          
          \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
          
          \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for each locus}
          
              \PY{c+c1}{\PYZsh{}\PYZsh{} Set REF and ALT alleles for the record (sexual R always REF)}
              
              \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
              
              \PY{n}{sample\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{sample\PYZus{}fields} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              
              \PY{n}{N\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
              
              
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}    FOR A\PYZhy{}LOCI    \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              
              
              \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                  
                  \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
          
                  \PY{n}{R\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  \PY{n}{L\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  
                  \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                      
                      \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                      
                          \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                  
                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                       
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
          
                      \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                          \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                          \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                          
                          \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                          \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                          
                          \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                          \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                          \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                      
          
                      
                      \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
          
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                          \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
          
                          \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
          
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                  
                  \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                      \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                      \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                  
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                  
                  \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{record}\PY{o}{.}\PY{n}{num\PYZus{}called}\PY{o}{*}\PY{l+m+mf}{0.25}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                          
                      \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{REF}\PY{p}{,} \PY{n}{ALT}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                      \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
          
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
              
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}   C \PYZhy{} loci   \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              
              
              
              \PY{k}{elif} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                  
                  \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
          
                  \PY{n}{c\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  \PY{n}{c\PYZus{}R2\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  
                  \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                      
                      \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  (mothers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                      
                          \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{c+c1}{\PYZsh{}\PYZsh{} It is not possible to phase these loci in the mothers, so I will alternate which subgenome gets the c\PYZus{}R2 allele.}
                                  
                                  \PY{k}{if} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                                      \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{2}
                                  
                                      \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                      \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                      \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  \PY{k}{elif} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                                      \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
                                  
                                      \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                      \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                      \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
          
                              \PY{c+c1}{\PYZsh{}\PYZsh{} Here if the sample is heterozygous}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  \PY{c+c1}{\PYZsh{}\PYZsh{} Note that in the curation I already made sure that the c\PYZus{}R2 alleles must be on the sexual R, not the [R]}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                  
                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                       
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES (fathers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
          
                      \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                          \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                          \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                          
                          \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                          \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                          
                          \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                          \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                          \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                      
          
                      
                      \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
          
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                          \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
          
                          \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
          
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                  
                  \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                      \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                      \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                  
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                  
                  \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{record}\PY{o}{.}\PY{n}{num\PYZus{}called}\PY{o}{*}\PY{l+m+mf}{0.25}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                          
                      \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{REF}\PY{p}{,} \PY{n}{ALT}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                      \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
          
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
          
              
              
              \PY{k}{else}\PY{p}{:}
                  \PY{k}{pass} 
          
          \PY{n}{outvcf}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci dropped due to missing data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{loci\PYZus{}dropped}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
111 loci dropped due to missing data

    \end{Verbatim}

    So lets see what this does to the PCA

    \subsection{PCA}\label{pca}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PYZpc{}\PYZpc{}bash
        
        \PY{n+nv}{wd}\PY{o}{=}/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted  \PY{c+c1}{\PYZsh{}\PYZsh{} just change this line}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All data }
        sed \PY{l+s+s1}{\PYZsq{}s/\PYZus{}/\PYZhy{}/g\PYZsq{}} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW3\PYZus{}haps.vcf \PYZgt{} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf
        
        \PYZti{}/Programs/plink\PYZus{}linux\PYZus{}x86\PYZus{}64/plink \PYZhy{}\PYZhy{}vcf \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf \PYZhy{}\PYZhy{}recode A \PYZhy{}\PYZhy{}allow\PYZhy{}extra\PYZhy{}chr \PYZhy{}out \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{o}{\PYZpc{}\PYZpc{}}R
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Load packages and functions needed}
        
        \PY{k+kn}{library}\PY{p}{(}adegenet\PY{p}{)}
        \PY{k+kn}{library}\PY{p}{(}ggplot2\PY{p}{)}
        \PY{k+kn}{source}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZti{}/Dropbox/My\PYZus{}Dropbox\PYZus{}Scripts/R/My\PYZus{}functions/Sex\PYZus{}sorter\PYZus{}PCA\PYZus{}plotting\PYZus{}function.R\PYZdq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Reading in the data \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        \PY{k+kp}{setwd}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted\PYZdq{}}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All SNPs }
        alldata \PY{o}{\PYZlt{}\PYZhy{}} read.PLINK\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink.raw\PYZsq{}}\PY{p}{,} chunkSize\PY{o}{=}\PY{l+m}{1000}\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores\PY{o}{=}\PY{l+m}{1}\PY{p}{,} saveNbAlleles\PY{o}{=}\PY{n+nb+bp}{T}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Running PCA \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        pca1 \PY{o}{\PYZlt{}\PYZhy{}} glPca\PY{p}{(}alldata\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores \PY{o}{=} \PY{l+m}{6}\PY{p}{,} nf \PY{o}{=} \PY{l+m}{5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}751}]:} \PY{o}{\PYZpc{}\PYZpc{}}R \PY{o}{\PYZhy{}}w \PY{l+m}{50} \PY{o}{\PYZhy{}}h \PY{l+m}{50} \PY{o}{\PYZhy{}}u cm
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} Plotting the PCAs using the Sex\PYZus{}sorter function.}
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} Sex information \PYZhy{} just a two column text file with the sample name in the first column and the sex (M or F) in the second column. Its for labelling the PCA}
          sexes \PY{o}{\PYZlt{}\PYZhy{}} read.delim\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/popmap\PYZus{}pops\PYZus{}only\PYZus{}KEPT.txt\PYZdq{}}\PY{p}{,} header \PY{o}{=} \PY{n+nb+bp}{F}\PY{p}{)}
          
          Sex\PYZus{}sorter\PY{p}{(}pca1\PY{p}{,}   \PY{c+c1}{\PYZsh{}\PYZsh{} PCA object}
                     sexes\PY{p}{,}  \PY{c+c1}{\PYZsh{}\PYZsh{} sex\PYZus{}info file}
                     \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{1}\PY{p}{,}\PY{l+m}{2}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} which components to plotb}
                     Title \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Phased Hybridogens\PYZus{}all samples\PYZus{}PC\PYZus{}1\PYZus{}2\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} plot title}
                     xtitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC3\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} X axis title}
                     ytitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC4\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Y axis title }
                     Palette \PY{o}{=} rainbow\PY{p}{(}\PY{l+m}{6}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Colours to use}
                     func\PYZus{}cex \PY{o}{=} \PY{l+m}{5}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZsh{} Size of points and text in plots)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_74_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Great, we now have some variation between out R genomes as expected.
Lets keep going, adding other locus categories

    \subsection{D loci}\label{d-loci}

    D loci are similar to C loci but are easier to phase as they are
homozygous in the mother. These should be pretty informative between R
lineages.

Expectations for D loci are the same as for C.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} D\PYZhy{}loci curation}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         
         \PY{n}{All\PYZus{}fams} \PY{o}{=} \PY{p}{[} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}25}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}41}\PY{p}{]}
         
         \PY{n}{phased\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}phased} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{d\PYZus{}R\PYZus{}alleles\PYZus{}homozygous\PYZus{}in\PYZus{}RL} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}phased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{D\PYZus{}loci\PYZus{}multiphased\PYZus{}kept} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{D\PYZus{}loci\PYZus{}single\PYZus{}kept} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphase\PYZus{}not\PYZus{}on\PYZus{}Rclon} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}not\PYZus{}on\PYZus{}Rclon} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{KEPT} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{Kept\PYZus{}D\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} CHECK for C loci \PYZhy{} if phased in more than one family, are the phasings for this locus consistent?}
             \PY{c+c1}{\PYZsh{}\PYZsh{} loop over each family phasing dictionary, get the c and c\PYZus{}R2 alleles and check that they are consistent.}
             
             \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
             \PY{n}{d} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{d\PYZus{}R} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False} 
             \PY{n}{families\PYZus{}phased} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{d\PYZus{}R\PYZus{}behaviour\PYZus{}OK} \PY{o}{=} \PY{n+nb+bp}{False}
             
             \PY{k}{for} \PY{n}{family} \PY{o+ow}{in} \PY{n}{All\PYZus{}fams}\PY{p}{:}
                 
                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                     \PY{n}{families\PYZus{}phased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
                     \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{True}  \PY{c+c1}{\PYZsh{}\PYZsh{} if incosnsitencies arise, this will change to false and the locus will not be used. }
                     
                     \PY{k}{if} \PY{n}{d} \PY{o}{==} \PY{n}{d\PYZus{}R} \PY{o}{==} \PY{n+nb+bp}{None}\PY{p}{:}
                         \PY{n}{d} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{d\PYZus{}R} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                     
                     \PY{k}{elif} \PY{o+ow}{not} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{d}\PY{p}{,} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{D\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{d\PYZus{}R}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False}
                         
                
             \PY{c+c1}{\PYZsh{}\PYZsh{} Check 2) \PYZhy{} if phased in only one family, check that the d\PYZus{}R allele is not homozygous in RL offspring (over the threshold. **Note that a couple of missed heterozygous calls can be due to low coverage, }
             \PY{c+c1}{\PYZsh{}\PYZsh{} and can be tolerated, but if many offspring don\PYZsq{}t are homozygous for the d\PYZus{}R allele, this is indicative of a null allele and the locus should not be used).             }
                         
             \PY{k}{if} \PY{n}{record\PYZus{}phased}\PY{p}{:}
                 \PY{n}{phased\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{d\PYZus{}R\PYZus{}homozygous\PYZus{}RL} \PY{o}{=} \PY{l+m+mi}{0}
             
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
         
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                         \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R}\PY{p}{,} \PY{n}{d\PYZus{}R}\PY{p}{)}\PY{p}{:}
                             \PY{n}{d\PYZus{}R\PYZus{}homozygous\PYZus{}RL} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
             
                 \PY{n}{R\PYZus{}Rclon\PYZus{}families} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 
                 \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                 
         
                 \PY{k}{for} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{R\PYZus{}Rclon\PYZus{}families}\PY{p}{:}
                     
                     \PY{n}{called\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{0}
                     \PY{n}{het\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{0}
                     
                     \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                         
                         \PY{k}{if} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{and} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                             
                             \PY{n}{called\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het} \PY{o+ow}{and} \PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d}\PY{p}{,} \PY{n}{d\PYZus{}R}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R}\PY{p}{,} \PY{n}{d}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                                     
                                 \PY{n}{het\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{if} \PY{n}{called\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                         \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{n}{het\PYZus{}R\PYZus{}Rclon\PYZus{}samples} \PY{o}{/} \PY{n}{called\PYZus{}R\PYZus{}Rclon\PYZus{}samples}
                     
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}
                         
                 \PY{c+c1}{\PYZsh{}print record.ID, \PYZdq{}25\PYZdq{}, R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}25\PYZdq{}], \PYZdq{}27\PYZdq{}, R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}27\PYZdq{}], \PYZdq{}30\PYZdq{}, R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}30\PYZdq{}],\PYZdq{}39\PYZdq{},  R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}39\PYZdq{}], \PYZdq{}41\PYZdq{}, R\PYZus{}Rclon\PYZus{}heterozygosities[\PYZdq{}41\PYZdq{}]}
             
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} Now use the results of these three checks to decide whether to keep the locus or not. }
             
             \PY{k}{if} \PY{n}{families\PYZus{}phased} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                 \PY{n}{multiphased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{if} \PY{n}{multiphased\PYZus{}ok}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus is phased in more than one family and the phasings agree.}
                     \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     
                     \PY{c+c1}{\PYZsh{}\PYZsh{} If the locus is never heterozygous in more than 70\PYZpc{} of [R]R samples (thus can\PYZsq{}t be on the [R])}
                     \PY{k}{if} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7}\PY{p}{:}
                             
                         \PY{n}{multiphase\PYZus{}not\PYZus{}on\PYZus{}Rclon} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                     \PY{k}{if} \PY{n}{d\PYZus{}R\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If the d\PYZus{}R allele is never in RL samples and never homozygous. }
                     
                         \PY{n}{D\PYZus{}loci\PYZus{}multiphased\PYZus{}kept} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1} 
                         
                     \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{,}
                             \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{,}
                             \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{,}
                             \PY{n}{d\PYZus{}R\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} If the c\PYZus{}R2 allele is never in RL samples and never homozygous. }
                     
                             
                         \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                         \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{d}
                         \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{d\PYZus{}R}
                         
          
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} If the locus is only phased in one family }
             
             \PY{k}{elif} \PY{n}{families\PYZus{}phased} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                 
                 \PY{n}{single\PYZus{}phased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{k}{if} \PY{n}{d\PYZus{}R\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the c\PYZus{}R2 locus is never in RL samples and it is (almost) never homozygous, must be an C locus}
                     
                     \PY{n}{D\PYZus{}loci\PYZus{}single\PYZus{}kept} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
                 \PY{c+c1}{\PYZsh{}\PYZsh{} If the locus is never heterozygous in more than 70\PYZpc{} of [R]R samples (thus can\PYZsq{}t be on the [R])}
                 \PY{k}{if} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7}\PY{p}{:}
                             
                     \PY{n}{single\PYZus{}not\PYZus{}on\PYZus{}Rclon} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}    
                     
                 \PY{k}{if} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{R\PYZus{}Rclon\PYZus{}heterozygosities}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.7} \PY{o+ow}{and} \PY{n}{c\PYZus{}R2\PYZus{}homozygous\PYZus{}RL} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
         
                     \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}     
                     \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                     \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{d}
                     \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{d\PYZus{}R}
                     
         
             
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ records phased}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{phased\PYZus{}count}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ are phased in more than one family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have matching phasings across families}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased\PYZus{}ok\PYZus{}count}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have d\PYZus{}R alleles which are never homozygous in RL samples}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{D\PYZus{}loci\PYZus{}multiphased\PYZus{}kept}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{and }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have c\PYZus{}R2 alleles which are never heterozygous in all [R] samples in a family (i.e. not on the [R]) }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphase\PYZus{}not\PYZus{}on\PYZus{}Rclon}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci are phased in only one family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}}  \PY{n}{single\PYZus{}phased}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have d\PYZus{}R alleles which are never homozygous in RL samples}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{D\PYZus{}loci\PYZus{}single\PYZus{}kept}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{and }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have d\PYZus{}R alleles which are never heterozygous in all [R] samples in a family (i.e. not on the [R]) }\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{single\PYZus{}not\PYZus{}on\PYZus{}Rclon}
         
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ C loci kept (pass all checks)}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{KEPT}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
402 records phased
58 are phased in more than one family
Of which 56 have matching phasings across families
43 have d\_R alleles which are never homozygous in RL samples
and 14 have c\_R2 alleles which are never heterozygous in all [R] samples in a family (i.e. not on the [R]) 
344 loci are phased in only one family
Of which 241 have d\_R alleles which are never homozygous in RL samples
and 145 have d\_R alleles which are never heterozygous in all [R] samples in a family (i.e. not on the [R]) 
153 C loci kept (pass all checks)

    \end{Verbatim}

    Ok, now add these to the VCF maker again and repeat the PCA

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}753}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{n}{vcf\PYZus{}path} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie//Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1.vcf}\PY{l+s+s2}{\PYZdq{}}
          \PY{n}{outvcf} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW3\PYZus{}haps.vcf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{10}
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} write headers}
          
          \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n+nb}{open}\PY{p}{(}\PY{n}{hap\PYZus{}vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}\PYZsh{}FORMAT=\PYZlt{}ID=GL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                  \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{line}\PY{p}{)}
          
          \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{False}
          
          \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} 
          
          \PY{n}{discordant\PYZus{}A\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}A\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{discordant\PYZus{}B\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}B\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{discordant\PYZus{}C\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}C\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{discordant\PYZus{}D\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{n}{discordant\PYZus{}D\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          
          \PY{n}{loci\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
          
          \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
          
          \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for each locus}
          
              \PY{c+c1}{\PYZsh{}\PYZsh{} Set REF and ALT alleles for the record (sexual R always REF)}
              
              \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
              
              \PY{n}{sample\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              \PY{n}{sample\PYZus{}fields} \PY{o}{=} \PY{p}{[}\PY{p}{]}
              
              \PY{n}{N\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
              
              
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}    FOR A\PYZhy{}LOCI    \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              
              
              \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                  
                  \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
          
                  \PY{n}{R\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  \PY{n}{L\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  
                  \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                      
                      \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                      
                          \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                  
                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                       
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
          
                      \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                          \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                          \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                          
                          \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                          \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                          
                          \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                          \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                          \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                      
          
                      
                      \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
          
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                          \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
          
                          \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
          
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                  
                  \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                      \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                      \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                  
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                  
                  \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{record}\PY{o}{.}\PY{n}{num\PYZus{}called}\PY{o}{*}\PY{l+m+mf}{0.25}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                          
                      \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{REF}\PY{p}{,} \PY{n}{ALT}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                      \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
          
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
              
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}   C \PYZhy{} loci   \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              
              
              
              \PY{k}{elif} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                  
                  \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
          
                  \PY{n}{c\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  \PY{n}{c\PYZus{}R2\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  
                  \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                      
                      \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  (mothers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                      
                          \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{c+c1}{\PYZsh{}\PYZsh{} It is not possible to phase these loci in the mothers, so I will alternate which subgenome gets the c\PYZus{}R2 allele.}
                                  
                                  \PY{k}{if} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                                      \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{2}
                                  
                                      \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                      \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                      \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  \PY{k}{elif} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                                      \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
                                  
                                      \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                      \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                      \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
          
                              \PY{c+c1}{\PYZsh{}\PYZsh{} Here if the sample is heterozygous}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  \PY{c+c1}{\PYZsh{}\PYZsh{} Note that in the curation I already made sure that the c\PYZus{}R2 alleles must be on the sexual R, not the [R]}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                  
                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                       
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES (fathers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
          
                      \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                          \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                          \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                          
                          \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                          \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                          
                          \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                          \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                          \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                      
          
                      
                      \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
          
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                          \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
          
                          \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
          
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                  
                  \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                      \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                      \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                  
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                  
                  \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{record}\PY{o}{.}\PY{n}{num\PYZus{}called}\PY{o}{*}\PY{l+m+mf}{0.25}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                          
                      \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{REF}\PY{p}{,} \PY{n}{ALT}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                      \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
          
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
          
              
              
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}   D \PYZhy{} loci   \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
              \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}    }
              
              
              
              \PY{k}{elif} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                  
                  \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
          
                  \PY{n}{d\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  \PY{n}{d\PYZus{}R\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                  
                  \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                      
                      \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  (mothers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                      
                          \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{c+c1}{\PYZsh{}\PYZsh{} It is not possible to phase these loci in the mothers, so I will alternate which subgenome gets the c\PYZus{}R2 allele.}
                                  
                                  \PY{k}{if} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                                      \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{2}
                                  
                                      \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                      \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                      \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  \PY{k}{elif} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                                      \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
                                  
                                      \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                      \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                      \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                      \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                      \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
          
                              \PY{c+c1}{\PYZsh{}\PYZsh{} Here if the sample is heterozygous}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                                  \PY{c+c1}{\PYZsh{}\PYZsh{} Note that in the curation I already made sure that the c\PYZus{}R2 alleles must be on the sexual R, not the [R]}
                              
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                  
                  
                          
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
                       
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES (fathers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                          
                          
                          \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                              
                              \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                              
                              \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                              \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
          
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                              \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                              
          
                              \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                  
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
          
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                  
                              \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                  
                              
                              \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                  
                                  \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                  
                                  \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                      \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                  \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                      
                                  \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                  \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                      
                                  \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                  \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                  \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                  
          
                      \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                          
                          \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                          \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                          
                          \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                          \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                          
                          \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                          \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                          
                          \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                          \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                          \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                          \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                      
          
                      
                      \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                      
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
          
                          \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                          \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
          
                          \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                          \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
          
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                          \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
          
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                  
                  \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                      \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                      \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                  
                  
                  \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                  
                  \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{record}\PY{o}{.}\PY{n}{num\PYZus{}called}\PY{o}{*}\PY{l+m+mf}{0.25}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                          
                      \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{REF}\PY{p}{,} \PY{n}{ALT}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                      \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
          
                      \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                  \PY{k}{else}\PY{p}{:}
                      \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
              
              
              
              \PY{k}{else}\PY{p}{:}
                  \PY{k}{pass} 
          
          \PY{n}{outvcf}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}
          \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci dropped due to missing data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{loci\PYZus{}dropped}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
170 loci dropped due to missing data

    \end{Verbatim}

    \subsection{PCA}\label{pca}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PYZpc{}\PYZpc{}bash
        
        \PY{n+nv}{wd}\PY{o}{=}/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted  \PY{c+c1}{\PYZsh{}\PYZsh{} just change this line}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All data }
        sed \PY{l+s+s1}{\PYZsq{}s/\PYZus{}/\PYZhy{}/g\PYZsq{}} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW3\PYZus{}haps.vcf \PYZgt{} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf
        
        \PYZti{}/Programs/plink\PYZus{}linux\PYZus{}x86\PYZus{}64/plink \PYZhy{}\PYZhy{}vcf \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf \PYZhy{}\PYZhy{}recode A \PYZhy{}\PYZhy{}allow\PYZhy{}extra\PYZhy{}chr \PYZhy{}out \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{o}{\PYZpc{}\PYZpc{}}R
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Load packages and functions needed}
        
        \PY{k+kn}{library}\PY{p}{(}adegenet\PY{p}{)}
        \PY{k+kn}{library}\PY{p}{(}ggplot2\PY{p}{)}
        \PY{k+kn}{source}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZti{}/Dropbox/My\PYZus{}Dropbox\PYZus{}Scripts/R/My\PYZus{}functions/Sex\PYZus{}sorter\PYZus{}PCA\PYZus{}plotting\PYZus{}function.R\PYZdq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Reading in the data \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        \PY{k+kp}{setwd}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted\PYZdq{}}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All SNPs }
        alldata \PY{o}{\PYZlt{}\PYZhy{}} read.PLINK\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink.raw\PYZsq{}}\PY{p}{,} chunkSize\PY{o}{=}\PY{l+m}{1000}\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores\PY{o}{=}\PY{l+m}{1}\PY{p}{,} saveNbAlleles\PY{o}{=}\PY{n+nb+bp}{T}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Running PCA \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        pca1 \PY{o}{\PYZlt{}\PYZhy{}} glPca\PY{p}{(}alldata\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores \PY{o}{=} \PY{l+m}{6}\PY{p}{,} nf \PY{o}{=} \PY{l+m}{5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}756}]:} \PY{o}{\PYZpc{}\PYZpc{}}R \PY{o}{\PYZhy{}}w \PY{l+m}{50} \PY{o}{\PYZhy{}}h \PY{l+m}{50} \PY{o}{\PYZhy{}}u cm
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} Plotting the PCAs using the Sex\PYZus{}sorter function.}
          
          \PY{c+c1}{\PYZsh{}\PYZsh{} Sex information \PYZhy{} just a two column text file with the sample name in the first column and the sex (M or F) in the second column. Its for labelling the PCA}
          sexes \PY{o}{\PYZlt{}\PYZhy{}} read.delim\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/popmap\PYZus{}pops\PYZus{}only\PYZus{}KEPT.txt\PYZdq{}}\PY{p}{,} header \PY{o}{=} \PY{n+nb+bp}{F}\PY{p}{)}
          
          Sex\PYZus{}sorter\PY{p}{(}pca1\PY{p}{,}   \PY{c+c1}{\PYZsh{}\PYZsh{} PCA object}
                     sexes\PY{p}{,}  \PY{c+c1}{\PYZsh{}\PYZsh{} sex\PYZus{}info file}
                     \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{1}\PY{p}{,}\PY{l+m}{2}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} which components to plotb}
                     Title \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Phased Hybridogens\PYZus{}all samples\PYZus{}PC\PYZus{}1\PYZus{}2\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} plot title}
                     xtitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC3\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} X axis title}
                     ytitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC4\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Y axis title }
                     Palette \PY{o}{=} rainbow\PY{p}{(}\PY{l+m}{6}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Colours to use}
                     func\PYZus{}cex \PY{o}{=} \PY{l+m}{5}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZsh{} Size of points and text in plots)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_84_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    This didn't add too much more signal, but C and D loci should be
analagous in the signal they provide, so its not too surprising.

    \subsection{B loci}\label{b-loci}

    Finally, we add the B-loci. These should be instrumental in bringing out
the structure between the clonal R genomes and the sexual Rs.

So we can only have B-loci in families 27, 30 and 39.

We expect that an allele that is derived on the branch leading to a
clonal {[}R{]} genome can never be homozygous. And it can only be found
in either {[}R{]}R or {[}R{]}{[}L{]} samples. So we will do two checks
here:

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  If phased in more than one family, do the phases match.
\item
  regardless of how many families it is phased in, is the b\_R1 allele
  ever homozygous, or ever in an RL sample? If so discard the locus.
\end{enumerate}

easy!

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{c+c1}{\PYZsh{}\PYZsh{} B\PYZhy{}loci curation }
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         
         \PY{n}{Rclon\PYZus{}fams} \PY{o}{=} \PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{]}
         
         \PY{n}{phased\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{multiphased} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{multi\PYZus{}homozygous\PYZus{}in\PYZus{}RLs} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{single\PYZus{}phased} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}homozygous\PYZus{}in\PYZus{}RLs} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{single\PYZus{}phased\PYZus{}ok\PYZus{}count} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{KEPT} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{Kept\PYZus{}B\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{} CHECK 1) \PYZhy{} if phased in more than one family, are the phasings for this locus consistent?}
             \PY{c+c1}{\PYZsh{}\PYZsh{} loop over each family phasing dictionary, get the a and b\PYZus{}R1 alleles and check that they are consistent.}
             
             \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
             \PY{n}{b} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{b\PYZus{}R1} \PY{o}{=} \PY{n+nb+bp}{None}
             \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False} 
             \PY{n}{families\PYZus{}phased} \PY{o}{=} \PY{l+m+mi}{0}
             \PY{n}{b\PYZus{}R1\PYZus{}behaviour\PYZus{}OK} \PY{o}{=} \PY{n+nb+bp}{False}
             
             \PY{k}{for} \PY{n}{family} \PY{o+ow}{in} \PY{n}{Rclon\PYZus{}fams}\PY{p}{:}
                 
                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                     \PY{n}{families\PYZus{}phased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
                     \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{False}   
                     
                     \PY{k}{if} \PY{n}{b} \PY{o}{==} \PY{n}{b\PYZus{}R1} \PY{o}{==} \PY{n+nb+bp}{None}\PY{p}{:}
                         \PY{n}{b} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                         \PY{n}{b\PYZus{}R1} \PY{o}{=} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                     
                     \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{b}\PY{p}{,} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{==} \PY{n}{b\PYZus{}R1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{n}{multiphased\PYZus{}ok} \PY{o}{=} \PY{n+nb+bp}{True}
                         
         
             \PY{c+c1}{\PYZsh{}\PYZsh{} Check 2) \PYZhy{} check that the b\PYZus{}R1 allele is never homozygous and never present in RL samples.             }
                         
             \PY{k}{if} \PY{n}{record\PYZus{}phased}\PY{p}{:}
                 \PY{n}{phased\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
                 \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{b\PYZus{}R1\PYZus{}homozygous\PYZus{}in\PYZus{}RLs} \PY{o}{=} \PY{l+m+mi}{0}
                 
                 \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                 \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                 
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
         
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                         \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                         \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}R1}\PY{p}{,} \PY{n}{b\PYZus{}R1}\PY{p}{)}\PY{p}{:}
                             \PY{n}{b\PYZus{}R1\PYZus{}homozygous\PYZus{}in\PYZus{}RLs} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                                   
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Another thing is that if an [R]R sample is het at a B locus phased in another family, that locus could be the opposit phase (because a lot of variation is likely shared between [R]s and Rs)}
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} So here I will check to see how often the b\PYZus{}R1 allele is on the clonal R in families other than that in which it was phased. }
                 
                 
                 
                 \PY{n}{RR\PYZus{}samples\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{RRs\PYZus{}heterozygous} \PY{o}{=} \PY{l+m+mi}{0}
                 
                 \PY{k}{for} \PY{n}{fam} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}    
                     
                     \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                     
                     \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                                         
                         \PY{k}{if} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{and} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{and} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                             
                             \PY{n}{RR\PYZus{}samples\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                             
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                                 \PY{n}{RRs\PYZus{}heterozygous} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 
                     \PY{k}{if} \PY{n}{RR\PYZus{}samples\PYZus{}called} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                         \PY{k}{if} \PY{n}{RRs\PYZus{}heterozygous}\PY{o}{/}\PY{n}{RR\PYZus{}samples\PYZus{}called} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.2}\PY{p}{:}
                             \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bb}\PY{l+s+s2}{\PYZdq{}}
         
                         \PY{k}{elif} \PY{l+m+mf}{0.3} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{RRs\PYZus{}heterozygous}\PY{o}{/}\PY{n}{RR\PYZus{}samples\PYZus{}called} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{:}
                             \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}sexual\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}
         
                         \PY{k}{elif} \PY{n}{RRs\PYZus{}heterozygous}\PY{o}{/}\PY{n}{RR\PYZus{}samples\PYZus{}called} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{:}
                             \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}clonal\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}
         
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inconclusive}\PY{l+s+s2}{\PYZdq{}}
                             
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{missing}\PY{l+s+s2}{\PYZdq{}}
                         
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} And I have to do the same thing for the RL samples.}
                 
                 \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{=} \PY{l+m+mi}{0}
                 \PY{n}{RLs\PYZus{}heterozygous} \PY{o}{=} \PY{l+m+mi}{0}
                 
                 \PY{k}{for} \PY{n}{fam} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{25}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}    
                     
                     \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                     
                     \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                                         
                         \PY{k}{if} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{and} \PY{n}{GT\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{RL}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{and} \PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{:}
                             
                             \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                             
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het}\PY{p}{:}
                                 \PY{n}{RLs\PYZus{}heterozygous} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 
                     \PY{k}{if} \PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{\PYZgt{}} \PY{l+m+mi}{0}\PY{p}{:}
                         \PY{k}{if} \PY{n}{RLs\PYZus{}heterozygous}\PY{o}{/}\PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.2}\PY{p}{:}
                             \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bb}\PY{l+s+s2}{\PYZdq{}}
         
                         \PY{k}{elif} \PY{l+m+mf}{0.3} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{RLs\PYZus{}heterozygous}\PY{o}{/}\PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{:}
                             \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}sexual\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}
         
                         \PY{k}{elif} \PY{n}{RLs\PYZus{}heterozygous}\PY{o}{/}\PY{n}{RL\PYZus{}samples\PYZus{}called} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{:}
                             \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}clonal\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}
         
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inconclusive}\PY{l+s+s2}{\PYZdq{}}
                             
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{missing}\PY{l+s+s2}{\PYZdq{}}
         
                    
         
            
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Now use the results of these two checks to decide whether to keep the locus or not. }
         
                 \PY{k}{if} \PY{n}{families\PYZus{}phased} \PY{o}{\PYZgt{}} \PY{l+m+mi}{1}\PY{p}{:}
                     \PY{n}{multiphased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                     \PY{k}{if} \PY{n}{multiphased\PYZus{}ok}\PY{p}{:}
                         \PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                         \PY{k}{if} \PY{n}{b\PYZus{}R1\PYZus{}homozygous\PYZus{}in\PYZus{}RLs} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{:}
                             \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                             \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                             \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{b\PYZus{}R1}
                             \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{b}
                             
                         \PY{k}{else}\PY{p}{:}
                             \PY{n}{multi\PYZus{}homozygous\PYZus{}in\PYZus{}RLs} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                             
                 \PY{k}{else}\PY{p}{:}
                     \PY{k}{if} \PY{n}{b\PYZus{}R1\PYZus{}homozygous\PYZus{}in\PYZus{}RLs} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{l+m+mi}{2}\PY{p}{:}
                         
                         \PY{n}{single\PYZus{}phased} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         
                         \PY{n}{KEPT} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}     
                         \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
                         \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{b\PYZus{}R1}
                         \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{b}
                         
                     \PY{k}{else}\PY{p}{:}
                         \PY{n}{single\PYZus{}homozygous\PYZus{}in\PYZus{}RLs} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                     
             
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ records phased}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{phased\PYZus{}count}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ are phased in more than one Rclon family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ have matching phasings across families}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{multiphased\PYZus{}ok\PYZus{}count}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ are never homozygous for the b\PYZus{}R1 allele in RL offspring}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{multiphased\PYZus{}ok\PYZus{}count} \PY{o}{\PYZhy{}} \PY{n}{multi\PYZus{}homozygous\PYZus{}in\PYZus{}RLs}\PY{p}{)}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci are phased in only one family}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{single\PYZus{}phased}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Of which }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ are never homozygous for the b\PYZus{}R1 allele in RL offspring}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{single\PYZus{}phased} \PY{o}{\PYZhy{}} \PY{n}{single\PYZus{}homozygous\PYZus{}in\PYZus{}RLs}\PY{p}{)}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ B loci kept}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{KEPT}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
255 records phased
19 are phased in more than one Rclon family
Of which 19 have matching phasings across families
Of which 19 are never homozygous for the b\_R1 allele in RL offspring
220 loci are phased in only one family
Of which 204 are never homozygous for the b\_R1 allele in RL offspring
239 B loci kept

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
         
         \PY{n}{outvcf} \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW4.vcf}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{w}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{cov\PYZus{}threshold} \PY{o}{=} \PY{l+m+mi}{10}
         
         \PY{n}{locus\PYZus{}drop\PYZus{}thresh} \PY{o}{=} \PY{l+m+mi}{20}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} write headers}
         
         \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{o+ow}{not} \PY{n}{line}\PY{o}{.}\PY{n}{startswith}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}\PYZsh{}FORMAT=\PYZlt{}ID=GL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{line}\PY{p}{)}
         
         \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{False}
         
         \PY{n}{myvcf} \PY{o}{=} \PY{n}{vcf}\PY{o}{.}\PY{n}{Reader}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{n}{vcf\PYZus{}path}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)} 
         
         \PY{n}{discordant\PYZus{}A\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{discordant\PYZus{}A\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{discordant\PYZus{}B\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{discordant\PYZus{}B\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{discordant\PYZus{}C\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{discordant\PYZus{}C\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{discordant\PYZus{}D\PYZus{}samples} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         \PY{n}{discordant\PYZus{}D\PYZus{}loci} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{loci\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{n}{maternal\PYZus{}het\PYZus{}b\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
         \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
         \PY{n}{maternal\PYZus{}het\PYZus{}d\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
         
         \PY{k}{for} \PY{n}{record} \PY{o+ow}{in} \PY{n}{myvcf}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} for each locus}
         
             \PY{c+c1}{\PYZsh{}\PYZsh{} Set REF and ALT alleles for the record (sexual R always REF)}
             
             \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{False}
             
             \PY{n}{sample\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             \PY{n}{sample\PYZus{}fields} \PY{o}{=} \PY{p}{[}\PY{p}{]}
             
             \PY{n}{N\PYZus{}dropped} \PY{o}{=} \PY{l+m+mi}{0}
             
             \PY{n}{NS} \PY{o}{=} \PY{l+m+mi}{0}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}    FOR A\PYZhy{}LOCI    \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             
             
             \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                 
                 \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
         
                 \PY{n}{R\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{a}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 \PY{n}{L\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                     
                     \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                     
                         \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                 
                 
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                      
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}A\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR LL SAMPLES \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{} still going to duplicate so I don\PYZsq{}t have to drastically change the structure of the code,  }
                         \PY{c+c1}{\PYZsh{}\PYZsh{} should just plot both on top of eachother}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is LL}
                             
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}LL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}LL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
                             
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                                 
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
         
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         
                             \PY{k}{else}\PY{p}{:}
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                     
                     
                     
                     \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                         
                         \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                         \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                         
                         \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                         \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
         
                         \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                         \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                         
                         \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                         \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                         
                         \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                         \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                     
         
                     
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
         
                         \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                         \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
         
                         \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                         \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
         
                         \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                         \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
         
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                 
                 \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                     \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                     \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                     \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                 
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                 
                 \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{locus\PYZus{}drop\PYZus{}thresh}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                         
                     \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{R\PYZus{}allele}\PY{p}{,} \PY{n}{L\PYZus{}allele}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                     \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
         
                     \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
             
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}   B \PYZhy{} loci   \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             
             
             
             \PY{k}{elif} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                 
                 \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
         
                 \PY{n}{b\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 \PY{n}{b\PYZus{}R1\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                     
                     \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  (mothers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                     
                         \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} It is not possible to phase these loci in the mothers, so I will alternate which subgenome gets the c\PYZus{}R2 allele.}
                                 
                                 \PY{k}{if} \PY{n}{maternal\PYZus{}het\PYZus{}b\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                                     \PY{n}{maternal\PYZus{}het\PYZus{}b\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{2}
                                 
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{k}{elif} \PY{n}{maternal\PYZus{}het\PYZus{}b\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                                     \PY{n}{maternal\PYZus{}het\PYZus{}b\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
                                 
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
         
                             \PY{c+c1}{\PYZsh{}\PYZsh{} Here if the sample is heterozygous I don\PYZsq{}t know a priori which genome the b\PYZus{}R1 allele is on so}
                             \PY{c+c1}{\PYZsh{}\PYZsh{} I will check the dictionary I made for [R]R samples in the curation step. }
                             
                             
                             \PY{c+c1}{\PYZsh{}  \PYZdq{}missing\PYZdq{} \PYZdq{}inconclusive\PYZdq{} \PYZdq{}b\PYZus{}on\PYZus{}clonal\PYZus{}R\PYZdq{} \PYZdq{}b\PYZus{}on\PYZus{}sexual\PYZus{}R\PYZdq{} \PYZdq{}bb\PYZdq{}}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{:}
                                     
                                     \PY{k}{for} \PY{n}{fam} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                                         \PY{k}{if} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                                             
                                             \PY{k}{if} \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{missing}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{or} \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inconclusive}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 
                                             \PY{k}{elif} \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}clonal\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                                 
                                             \PY{k}{elif} \PY{n}{RR\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}sexual\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} If its not in the phasing dict then add as missing data because I can\PYZsq{}t be sure which way the phasing should go.     }
                                 \PY{k}{else}\PY{p}{:}
                                     \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                     \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} Note that in the curation I already made sure that the c\PYZus{}R2 alleles must be on the sexual R, not the [R]}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{:}
                                     
                                     \PY{k}{for} \PY{n}{fam} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{25}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                                         
                                         \PY{k}{if} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                                             
                                             \PY{k}{if} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{missing}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{or} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inconclusive}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 
                                             \PY{k}{elif} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}sexual\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                                 
                                             \PY{k}{elif} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}clonal\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} If its not in the phasing dict then add as missing data because I can\PYZsq{}t be sure which way the phasing should go.     }
                                 \PY{k}{else}\PY{p}{:}
                                     \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                     \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                                 
                                 
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                 
                             
                             
                     
                     
                     
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{:}
                                     
                                     \PY{k}{for} \PY{n}{fam} \PY{o+ow}{in} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{25}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{30}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                                         
                                         \PY{k}{if} \PY{n}{fam} \PY{o+ow}{in} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{:}
                                             
                                             \PY{k}{if} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{missing}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{or} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inconclusive}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 
                                             \PY{k}{elif} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}sexual\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                                 
                                             \PY{k}{elif} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}clonal\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} If its not in the phasing dict then add as missing data because I can\PYZsq{}t be sure which way the phasing should go.     }
                                 \PY{k}{else}\PY{p}{:}
                                     \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                     \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                                 
                                 
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
         
                         
                         
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES (fathers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{c+c1}{\PYZsh{}\PYZsq{}13CZ3WF28M\PYZsq{}}
                         \PY{c+c1}{\PYZsh{}\PYZsq{}13CZ3WF31M\PYZsq{}}
                         \PY{c+c1}{\PYZsh{}\PYZsq{}13CZ3WF38M\PYZsq{}}
                         \PY{c+c1}{\PYZsh{}\PYZsq{}13CZ3WF40M}
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{:}
                                                                     
                                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF28M}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                         \PY{n}{fam} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{25}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF40M}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                         \PY{n}{fam} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{27}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF31M}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                         \PY{n}{fam} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{39}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{13CZ3WF38M}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                         \PY{n}{fam} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{41}\PY{l+s+s2}{\PYZdq{}}
                                         
                                             
                                     \PY{k}{if} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{missing}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{or} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{inconclusive}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                         \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                         \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                         \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                         \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                         \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                         \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                         \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                         \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                                 
                                     \PY{k}{elif} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}sexual\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                         \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                         \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                         \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                         \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                         \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                         \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                         \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                         \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                                 
                                     \PY{k}{elif} \PY{n}{RL\PYZus{}B\PYZus{}loci\PYZus{}phasing\PYZus{}dict}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{n}{fam}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{b\PYZus{}R1\PYZus{}on\PYZus{}clonal\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:}
                                                 
                                         \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                         \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                         \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                         \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                         \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                         \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                         \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                         \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} If its not in the phasing dict then add as missing data because I can\PYZsq{}t be sure which way the phasing should go.     }
                                 \PY{k}{else}\PY{p}{:}
                                     \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                     \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                                 
                                 
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}B\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}B\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                             
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR LL SAMPLES \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{} still going to duplicate so I don\PYZsq{}t have to drastically change the structure of the code,  }
                         \PY{c+c1}{\PYZsh{}\PYZsh{} should just plot both on top of eachother}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is LL}
                             
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}LL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}LL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
                             
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                                 
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
         
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         
                             \PY{k}{else}\PY{p}{:}
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                             
                             
         
                     \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                         
                         \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                         \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                         
                         \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                         \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
         
                         \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                         \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                         
                         \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                         \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                         
                         \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                         \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                     
         
                     
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
         
                         \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                         \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
         
                         \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                         \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
         
                         \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                         \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
         
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                 
                 \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                     \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                     \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                     \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                 
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                 
                 \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{locus\PYZus{}drop\PYZus{}thresh}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                         
                     \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{b\PYZus{}allele}\PY{p}{,} \PY{n}{b\PYZus{}R1\PYZus{}allele}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                     \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
         
                     \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
             
             
             
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}   C \PYZhy{} loci   \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             
             
             
             \PY{k}{elif} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                 
                 \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
         
                 \PY{n}{c\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 \PY{n}{c\PYZus{}R2\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{c\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                     
                     \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  (mothers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                     
                         \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} It is not possible to phase these loci in the mothers, so I will alternate which subgenome gets the c\PYZus{}R2 allele.}
                                 
                                 \PY{k}{if} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                                     \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{2}
                                 
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{k}{elif} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                                     \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
                                 
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
         
                             \PY{c+c1}{\PYZsh{}\PYZsh{} Here if the sample is heterozygous}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} Note that in the curation I already made sure that the c\PYZus{}R2 alleles must be on the sexual R, not the [R]}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                 
                 
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                 
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                      
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES (fathers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                 
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}C\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                                 
                                 
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR LL SAMPLES \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{} still going to duplicate so I don\PYZsq{}t have to drastically change the structure of the code,  }
                         \PY{c+c1}{\PYZsh{}\PYZsh{} should just plot both on top of eachother}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is LL}
                             
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}LL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}LL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
                             
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                                 
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
         
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         
                             \PY{k}{else}\PY{p}{:}
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
         
                     \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                         
                         \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                         \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                         
                         \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                         \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
         
                         \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                         \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                         
                         \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                         \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                         
                         \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                         \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                     
         
                     
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                         \PY{k}{if} \PY{o+ow}{not} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sample\PYZus{}1\PYZus{}gt}\PY{l+s+s2}{\PYZdq{}} \PY{o+ow}{in} \PY{n+nb}{locals}\PY{p}{(}\PY{p}{)}\PY{p}{:}
                             \PY{k}{print} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
         
                         \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                         \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
         
                         \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                         \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
         
                         \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                         \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
         
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                 
                 \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                     \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                     \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                     \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                 
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                 
                 \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{n}{locus\PYZus{}drop\PYZus{}thresh}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                         
                     \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{c\PYZus{}allele}\PY{p}{,} \PY{n}{c\PYZus{}R2\PYZus{}allele}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                     \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
         
                     \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
             
         
             
             
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}   D \PYZhy{} loci   \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
             \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}    }
             
             
             
             \PY{k}{elif} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{:}  \PY{c+c1}{\PYZsh{}\PYZsh{} if the locus has been phased for RL }
                 
                 \PY{n}{record\PYZus{}phased} \PY{o}{=} \PY{n+nb+bp}{True}
         
                 \PY{n}{d\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 \PY{n}{d\PYZus{}R\PYZus{}allele} \PY{o}{=} \PY{n}{Kept\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                 
                 \PY{k}{for} \PY{n}{sample} \PY{o+ow}{in} \PY{n}{record}\PY{o}{.}\PY{n}{samples}\PY{p}{:}
                     
                     \PY{k}{if} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{cov\PYZus{}threshold}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}R SAMPLES  (mothers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                     
                         \PY{k}{if} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R R}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} It is not possible to phase these loci in the mothers, so I will alternate which subgenome gets the c\PYZus{}R2 allele.}
                                 
                                 \PY{k}{if} \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                                     \PY{n}{maternal\PYZus{}het\PYZus{}c\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{2}
                                 
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{k}{elif} \PY{n}{maternal\PYZus{}het\PYZus{}d\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                                     \PY{n}{maternal\PYZus{}het\PYZus{}d\PYZus{}R2\PYZus{}loci\PYZus{}counter} \PY{o}{=} \PY{l+m+mi}{1}
                                 
                                     \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
                                     \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                     \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                     \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                     \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}R SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}R}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R]R}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L or Rclon allele always 1}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
         
                             \PY{c+c1}{\PYZsh{}\PYZsh{} Here if the sample is heterozygous}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} Note that in the curation I already made sure that the c\PYZus{}R2 alleles must be on the sexual R, not the [R]}
                             
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} c allele always 0}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR R\PYZus{}Lclon SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is R[L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}R}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                 
                 
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}L SAMPLES  \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}L}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                 
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                      
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR Rclon\PYZus{}Lclon SAMPLES (fathers) \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rclon\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is [R][L]}
                             
                             \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Rclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}Lclon}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
         
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{)} \PY{o+ow}{or} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1/1}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} R genome will have derived allele c\PYZus{}R2}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} \PY{c+c1}{\PYZsh{}\PYZsh{} L genome will have ancestral allele (c\PYZus{}allele)}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{k}{elif} \PY{n}{sample}\PY{o}{.}\PY{n}{gt\PYZus{}bases} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{/}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{)}\PY{p}{:}
                                 
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{0/0}\PY{l+s+s2}{\PYZdq{}} 
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+m+mi}{20}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                             \PY{c+c1}{\PYZsh{}\PYZsh{} RL samples cannot be homozygous for the c\PYZus{}R2 allele so we don\PYZsq{}t check for it here. }
                                 
                             
                             \PY{k}{else}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} keep a record of discordant loci and samples and set locus as missing in this sample}
                                 
                                 \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}samples}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{)}
                                 
                                 \PY{k}{if} \PY{n}{record}\PY{o}{.}\PY{n}{ID} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{:}
                                     \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                                 \PY{n}{discordant\PYZus{}D\PYZus{}loci}\PY{p}{[}\PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{)}
                                     
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                     
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} FOR LL SAMPLES \PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
                         
                         \PY{c+c1}{\PYZsh{}\PYZsh{} still going to duplicate so I don\PYZsq{}t have to drastically change the structure of the code,  }
                         \PY{c+c1}{\PYZsh{}\PYZsh{} should just plot both on top of eachother}
                         
                         
                         \PY{k}{elif} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{L\PYZus{}L}\PY{l+s+s2}{\PYZdq{}}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the sample is LL}
                             
                             
                             \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}LL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
                             \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}LL}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample}\PY{o}{.}\PY{n}{sample}
         
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}1}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample\PYZus{}1}\PY{p}{)}
                             \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}2}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{sample\PYZus{}2}\PY{p}{)}
                             
                             
                             \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o+ow}{and} \PY{n}{sample}\PY{o}{.}\PY{n}{is\PYZus{}het} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                                 
                                 \PY{n}{NS} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{2}
                                 
                                 \PY{c+c1}{\PYZsh{}\PYZsh{} make duplicate sample names}
         
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{GT}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AD}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         
                             \PY{k}{else}\PY{p}{:}
                                 \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
                                 \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
         
                                 \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                                 \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                                 \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                             
                             
                             
                             
                             
         
                                 
         
                     \PY{k}{elif} \PY{n+nb}{all}\PY{p}{(}\PY{p}{[}\PY{n+nb}{any}\PY{p}{(}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{called} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{sample}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DP}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{cov\PYZus{}threshold}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                         
                         \PY{c+c1}{\PYZsh{}print record.ID, sample.sample}
                         
                         \PY{n}{sample\PYZus{}1\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                         \PY{n}{sample\PYZus{}2\PYZus{}GT} \PY{o}{=} \PY{n}{GT\PYZus{}exp\PYZus{}dict}\PY{p}{[}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZus{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
                         
                         \PY{n}{sample\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}1\PYZus{}GT}\PY{p}{)}
                         \PY{n}{sample\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample}\PY{o}{.}\PY{n}{sample}\PY{p}{,} \PY{n}{sample\PYZus{}2\PYZus{}GT}\PY{p}{)}
         
                         \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1}\PY{p}{)}
                         \PY{n}{sample\PYZus{}names}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2}\PY{p}{)}
                         
                         \PY{n}{sample\PYZus{}1\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}} 
                         \PY{n}{sample\PYZus{}2\PYZus{}gt} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{./.}\PY{l+s+s2}{\PYZdq{}}
                         
                         \PY{n}{N\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                         \PY{n}{DP} \PY{o}{=} \PY{l+m+mi}{0}
                         \PY{n}{AD1\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD1\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD2\PYZus{}1} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                         \PY{n}{AD2\PYZus{}2} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{.}\PY{l+s+s2}{\PYZdq{}}
                     
         
                     
                     \PY{k}{if} \PY{n}{sample}\PY{o}{.}\PY{n}{sample} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{discards}\PY{p}{:}
                     
                         \PY{c+c1}{\PYZsh{}\PYZsh{} Now compile other data \PYZhy{} e.g. DP, AD, GL and construct the sample field string.}
         
                         \PY{c+c1}{\PYZsh{}\PYZsh{} Coverage is no longer informative in this pseudo\PYZhy{}synthetic VCF so will just say all loci are 20 reads deep, 10 reads per allele}
                         \PY{c+c1}{\PYZsh{}\PYZsh{} GL is also not useful, so will leave blank}
         
                         \PY{n}{sample\PYZus{}1\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD1\PYZus{}1}\PY{p}{,} \PY{n}{AD1\PYZus{}2}\PY{p}{)}
                         \PY{n}{sample\PYZus{}2\PYZus{}field} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{:}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{,}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}gt}\PY{p}{,} \PY{n}{DP}\PY{p}{,} \PY{n}{AD2\PYZus{}1}\PY{p}{,} \PY{n}{AD2\PYZus{}2}\PY{p}{)}
         
                         \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}1\PYZus{}field}\PY{p}{)}
                         \PY{n}{sample\PYZus{}fields}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sample\PYZus{}2\PYZus{}field}\PY{p}{)}
         
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Write sample line if not already done}
                 
                 \PY{k}{if} \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{==} \PY{n+nb+bp}{False}\PY{p}{:}
                     \PY{n}{sample\PYZus{}line} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZsh{}CHROM}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{POS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ID}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{REF}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ALT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{QUAL}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FILTER}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{INFO}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{FORMAT}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{sample\PYZus{}names}\PY{p}{)}
                     \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{sample\PYZus{}line}\PY{p}{)}
                     \PY{n}{sample\PYZus{}line\PYZus{}done} \PY{o}{=} \PY{n+nb+bp}{True}
                 
                 
                 \PY{c+c1}{\PYZsh{}\PYZsh{} Check that the number of samples dropped was not too high (if so remove the locus)}
                 
                 \PY{k}{if} \PY{n}{N\PYZus{}dropped} \PY{o}{\PYZlt{}} \PY{l+m+mi}{3}\PY{p}{:} \PY{c+c1}{\PYZsh{}\PYZsh{} if the number of loci dropped above is less than 25\PYZpc{} of the samples originally called, then output locus}
                         
                     \PY{n}{INFO\PYZus{}columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{.}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{PASS}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{NS=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{;AF=}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{GT:DP:AD}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{record}\PY{o}{.}\PY{n}{CHROM}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{POS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{ID}\PY{p}{,} \PY{n}{d\PYZus{}allele}\PY{p}{,} \PY{n}{d\PYZus{}R\PYZus{}allele}\PY{p}{,} \PY{n}{NS}\PY{p}{,} \PY{n}{record}\PY{o}{.}\PY{n}{INFO}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{]}
                     \PY{n}{line} \PY{o}{=} \PY{n}{INFO\PYZus{}columns} \PY{o}{+} \PY{n}{sample\PYZus{}fields}
         
                     \PY{n}{outvcf}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{loci\PYZus{}dropped} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
             
             
             
             \PY{k}{else}\PY{p}{:}
                 \PY{k}{pass} 
         
         \PY{n}{outvcf}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s2}{ loci dropped due to missing data}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{loci\PYZus{}dropped}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
324 loci dropped due to missing data

    \end{Verbatim}

    \subsection{PCA}\label{pca}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PYZpc{}\PYZpc{}bash
        
        \PY{n+nv}{wd}\PY{o}{=}/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted  \PY{c+c1}{\PYZsh{}\PYZsh{} just change this line}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All data }
        sed \PY{l+s+s1}{\PYZsq{}s/\PYZus{}/\PYZhy{}/g\PYZsq{}} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}NEW4.vcf \PYZgt{} \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf
        
        \PYZti{}/Programs/plink\PYZus{}linux\PYZus{}x86\PYZus{}64/plink \PYZhy{}\PYZhy{}vcf \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet.vcf \PYZhy{}\PYZhy{}recode A \PYZhy{}\PYZhy{}allow\PYZhy{}extra\PYZhy{}chr \PYZhy{}out \PY{n+nv}{\PYZdl{}wd}/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{o}{\PYZpc{}\PYZpc{}}R
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Load packages and functions needed}
        
        \PY{k+kn}{library}\PY{p}{(}adegenet\PY{p}{)}
        \PY{k+kn}{library}\PY{p}{(}ggplot2\PY{p}{)}
        \PY{k+kn}{source}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{\PYZti{}/Dropbox/My\PYZus{}Dropbox\PYZus{}Scripts/R/My\PYZus{}functions/Sex\PYZus{}sorter\PYZus{}PCA\PYZus{}plotting\PYZus{}function.R\PYZdq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Reading in the data \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        \PY{k+kp}{setwd}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted\PYZdq{}}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} All SNPs }
        alldata \PY{o}{\PYZlt{}\PYZhy{}} read.PLINK\PY{p}{(}\PY{l+s}{\PYZsq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/batch\PYZus{}1\PYZus{}PHASED\PYZus{}altered\PYZus{}adegenet\PYZus{}plink.raw\PYZsq{}}\PY{p}{,} chunkSize\PY{o}{=}\PY{l+m}{1000}\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores\PY{o}{=}\PY{l+m}{1}\PY{p}{,} saveNbAlleles\PY{o}{=}\PY{n+nb+bp}{T}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{}\PYZsh{} Running PCA \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
        
        pca1 \PY{o}{\PYZlt{}\PYZhy{}} glPca\PY{p}{(}alldata\PY{p}{,} parallel \PY{o}{=} \PY{k+kc}{TRUE}\PY{p}{,} n.cores \PY{o}{=} \PY{l+m}{6}\PY{p}{,} nf \PY{o}{=} \PY{l+m}{5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{o}{\PYZpc{}\PYZpc{}}R \PY{o}{\PYZhy{}}w \PY{l+m}{50} \PY{o}{\PYZhy{}}h \PY{l+m}{50} \PY{o}{\PYZhy{}}u cm
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Plotting the PCAs using the Sex\PYZus{}sorter function.}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Sex information \PYZhy{} just a two column text file with the sample name in the first column and the sex (M or F) in the second column. Its for labelling the PCA}
         sexes \PY{o}{\PYZlt{}\PYZhy{}} read.delim\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/popmap\PYZus{}pops\PYZus{}only\PYZus{}KEPT\PYZus{}haps.txt\PYZdq{}}\PY{p}{,} header \PY{o}{=} \PY{n+nb+bp}{F}\PY{p}{)}
         
         Sex\PYZus{}sorter\PY{p}{(}pca1\PY{p}{,}   \PY{c+c1}{\PYZsh{}\PYZsh{} PCA object}
                    sexes\PY{p}{,}  \PY{c+c1}{\PYZsh{}\PYZsh{} sex\PYZus{}info file}
                    \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{1}\PY{p}{,}\PY{l+m}{2}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} which components to plotb}
                    Title \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Phased Hybridogens\PYZus{}all samples\PYZus{}PC\PYZus{}1\PYZus{}2\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} plot title}
                    xtitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC1\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} X axis title}
                    ytitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC2\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Y axis title }
                    Palette \PY{o}{=} rainbow\PY{p}{(}\PY{l+m}{7}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Colours to use}
                    func\PYZus{}cex \PY{o}{=} \PY{l+m}{5}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZsh{} Size of points and text in plots)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{o}{\PYZpc{}\PYZpc{}}R \PY{o}{\PYZhy{}}w \PY{l+m}{50} \PY{o}{\PYZhy{}}h \PY{l+m}{50} \PY{o}{\PYZhy{}}u cm
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Plotting the PCAs using the Sex\PYZus{}sorter function.}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Sex information \PYZhy{} just a two column text file with the sample name in the first column and the sex (M or F) in the second column. Its for labelling the PCA}
         sexes \PY{o}{\PYZlt{}\PYZhy{}} read.delim\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/popmap\PYZus{}pops\PYZus{}only\PYZus{}KEPT\PYZus{}haps.txt\PYZdq{}}\PY{p}{,} header \PY{o}{=} \PY{n+nb+bp}{F}\PY{p}{)}
         
         Sex\PYZus{}sorter\PY{p}{(}pca1\PY{p}{,}   \PY{c+c1}{\PYZsh{}\PYZsh{} PCA object}
                    sexes\PY{p}{,}  \PY{c+c1}{\PYZsh{}\PYZsh{} sex\PYZus{}info file}
                    \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{1}\PY{p}{,}\PY{l+m}{3}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} which components to plotb}
                    Title \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Phased Hybridogens\PYZus{}all samples\PYZus{}PC\PYZus{}1\PYZus{}3\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} plot title}
                    xtitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC1\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} X axis title}
                    ytitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC3\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Y axis title }
                    Palette \PY{o}{=} rainbow\PY{p}{(}\PY{l+m}{7}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Colours to use}
                    func\PYZus{}cex \PY{o}{=} \PY{l+m}{5}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZsh{} Size of points and text in plots)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_94_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{o}{\PYZpc{}\PYZpc{}}R \PY{o}{\PYZhy{}}w \PY{l+m}{50} \PY{o}{\PYZhy{}}h \PY{l+m}{50} \PY{o}{\PYZhy{}}u cm
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Plotting the PCAs using the Sex\PYZus{}sorter function.}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{} Sex information \PYZhy{} just a two column text file with the sample name in the first column and the sex (M or F) in the second column. Its for labelling the PCA}
         sexes \PY{o}{\PYZlt{}\PYZhy{}} read.delim\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{/home/djeffrie/Data/RADseq/Hybridogens/populations\PYZus{}out\PYZus{}families\PYZus{}25\PYZus{}27\PYZus{}30\PYZus{}39\PYZus{}41\PYZus{}whitelisted/popmap\PYZus{}pops\PYZus{}only\PYZus{}KEPT\PYZus{}haps.txt\PYZdq{}}\PY{p}{,} header \PY{o}{=} \PY{n+nb+bp}{F}\PY{p}{)}
         
         Sex\PYZus{}sorter\PY{p}{(}pca1\PY{p}{,}   \PY{c+c1}{\PYZsh{}\PYZsh{} PCA object}
                    sexes\PY{p}{,}  \PY{c+c1}{\PYZsh{}\PYZsh{} sex\PYZus{}info file}
                    \PY{k+kt}{c}\PY{p}{(}\PY{l+m}{2}\PY{p}{,}\PY{l+m}{3}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} which components to plotb}
                    Title \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Phased Hybridogens\PYZus{}all samples\PYZus{}PC\PYZus{}2\PYZus{}3\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} plot title}
                    xtitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC2\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} X axis title}
                    ytitle \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{PC3\PYZdq{}}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Y axis title }
                    Palette \PY{o}{=} rainbow\PY{p}{(}\PY{l+m}{7}\PY{p}{)}\PY{p}{,} \PY{c+c1}{\PYZsh{}\PYZsh{} Colours to use}
                    func\PYZus{}cex \PY{o}{=} \PY{l+m}{5}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZsh{} Size of points and text in plots)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    So for the R clone, there are very few loci that are kept, mainly
because the {[}R{]} specific allele is present in some RR samples. Now
this is not unexpected, the {[}R{]} genome is not likely to have
accumulated a lot of private variation as it is reassimilated back into
the sexual R pool every generation.

So how many of those loci are in all three {[}R{]}'s ?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}174}]:} \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k+kn}{import} \PY{n}{Counter}
          \PY{n}{presence} \PY{o}{=} \PY{p}{[}\PY{p}{]}
          \PY{k}{for} \PY{n}{locus} \PY{o+ow}{in} \PY{n}{Kept\PYZus{}B\PYZus{}loci}\PY{p}{:}
              \PY{n}{counter} \PY{o}{=} \PY{l+m+mi}{0}
              \PY{k}{for} \PY{n}{family} \PY{o+ow}{in} \PY{n}{Rclon\PYZus{}fams}\PY{p}{:}
                  \PY{k}{if} \PY{n}{locus} \PY{o+ow}{in} \PY{n}{family}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{:}
                      \PY{n}{counter} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
          
              \PY{n}{presence}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{counter}\PY{p}{)}
          \PY{n}{Counter}\PY{p}{(}\PY{n}{presence}\PY{p}{)}
                      
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}174}]:} Counter(\{1: 29, 2: 1\})
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}168}]:} \PY{k+kn}{import} \PY{n+nn}{venn}
          \PY{n}{labels} \PY{o}{=} \PY{n}{venn}\PY{o}{.}\PY{n}{get\PYZus{}labels}\PY{p}{(}\PY{p}{[}\PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}27}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}30}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{phased\PYZus{}loci\PYZus{}fam\PYZus{}39}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{B\PYZus{}loci}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{fill}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{number}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{venn}\PY{o}{.}\PY{n}{venn3}\PY{p}{(}\PY{n}{labels}\PY{p}{,} \PY{n}{names}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fam\PYZus{}27\PYZus{}RclonR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fam\PYZus{}30\PYZus{}RclonR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{fam\PYZus{}39\PYZus{}RclonR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
          \PY{n}{fig}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_98_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Answer, none, 29 out of 30 are phased in only one family. The Venn
diagram does suggest that there are more phased loci shared between fam
27 and 30 (which have the same father) and the one locus phased in two
families is shared between fams 27 and 30. But overall there is not much
consistency between these genomes.

But if we want to ask where the {[}R{]} genomes came from, we could just
PCA all RR and {[}R{]}R samples together without phasing, that would
probably be enough - unless recombination is an issue?

    \subsection{Summary}\label{summary}

    So mission accomplished I think. . . we have phased loci across all
families and output the desired haploid VCF for all samples. This VCF
was used in the finestructure and phylogenetic analyses later in the
paper.


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
